<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Modelos de regresión generalizada – Modelos Estadísticos para la Predicción</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tema5.html" rel="next">
<link href="./tema3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1b90310288666db1f83ae9fc236520cd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tema4.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos de regresión generalizada</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelos Estadísticos para la Predicción</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción a los Modelos de Regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelo de regresión lineal: simple y múltiple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Métodos de selección de variables y problemas de regularización</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelos no lineales. Transformación de variables. Ingeniería de características.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos de regresión generalizada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Otros modelos de regresión: Modelos Aditivos Generalizados (GAMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conclusiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción-a-los-glm" id="toc-introducción-a-los-glm" class="nav-link active" data-scroll-target="#introducción-a-los-glm"><span class="header-section-number">5.1</span> Introducción a los GLM</a>
  <ul class="collapse">
  <li><a href="#qué-son-los-modelos-lineales-generalizados" id="toc-qué-son-los-modelos-lineales-generalizados" class="nav-link" data-scroll-target="#qué-son-los-modelos-lineales-generalizados"><span class="header-section-number">5.1.1</span> ¿Qué son los Modelos Lineales Generalizados?</a></li>
  <li><a href="#componentes-de-un-modelo-lineal-generalizado" id="toc-componentes-de-un-modelo-lineal-generalizado" class="nav-link" data-scroll-target="#componentes-de-un-modelo-lineal-generalizado"><span class="header-section-number">5.1.2</span> Componentes de un Modelo Lineal Generalizado</a></li>
  <li><a href="#diferencias-clave-entre-la-regresión-lineal-y-los-glm" id="toc-diferencias-clave-entre-la-regresión-lineal-y-los-glm" class="nav-link" data-scroll-target="#diferencias-clave-entre-la-regresión-lineal-y-los-glm"><span class="header-section-number">5.1.3</span> Diferencias clave entre la Regresión Lineal y los GLM</a></li>
  </ul></li>
  <li><a href="#regresión-logística" id="toc-regresión-logística" class="nav-link" data-scroll-target="#regresión-logística"><span class="header-section-number">5.2</span> Regresión Logística</a>
  <ul class="collapse">
  <li><a href="#fundamentos-de-la-regresión-logística" id="toc-fundamentos-de-la-regresión-logística" class="nav-link" data-scroll-target="#fundamentos-de-la-regresión-logística"><span class="header-section-number">5.2.1</span> Fundamentos de la Regresión Logística</a></li>
  <li><a href="#interpretación-de-coeficientes-y-odds-ratios" id="toc-interpretación-de-coeficientes-y-odds-ratios" class="nav-link" data-scroll-target="#interpretación-de-coeficientes-y-odds-ratios"><span class="header-section-number">5.2.2</span> Interpretación de coeficientes y Odds Ratios</a></li>
  <li><a href="#evaluación-del-modelo-logístico" id="toc-evaluación-del-modelo-logístico" class="nav-link" data-scroll-target="#evaluación-del-modelo-logístico"><span class="header-section-number">5.2.3</span> Evaluación del modelo Logístico</a></li>
  </ul></li>
  <li><a href="#regresión-de-poisson" id="toc-regresión-de-poisson" class="nav-link" data-scroll-target="#regresión-de-poisson"><span class="header-section-number">5.3</span> Regresión de Poisson</a>
  <ul class="collapse">
  <li><a href="#modelo-de-regresión-de-poisson" id="toc-modelo-de-regresión-de-poisson" class="nav-link" data-scroll-target="#modelo-de-regresión-de-poisson"><span class="header-section-number">5.3.1</span> Modelo de regresión de Poisson</a></li>
  <li><a href="#supuestos-y-limitaciones-de-la-regresión-de-poisson" id="toc-supuestos-y-limitaciones-de-la-regresión-de-poisson" class="nav-link" data-scroll-target="#supuestos-y-limitaciones-de-la-regresión-de-poisson"><span class="header-section-number">5.3.2</span> Supuestos y limitaciones de la regresión de Poisson</a></li>
  <li><a href="#interpretación-de-los-resultados" id="toc-interpretación-de-los-resultados" class="nav-link" data-scroll-target="#interpretación-de-los-resultados"><span class="header-section-number">5.3.3</span> Interpretación de los resultados</a></li>
  <li><a href="#evaluación-del-modelo-de-poisson" id="toc-evaluación-del-modelo-de-poisson" class="nav-link" data-scroll-target="#evaluación-del-modelo-de-poisson"><span class="header-section-number">5.3.4</span> Evaluación del modelo de Poisson</a></li>
  <li><a href="#limitaciones-y-alternativas" id="toc-limitaciones-y-alternativas" class="nav-link" data-scroll-target="#limitaciones-y-alternativas"><span class="header-section-number">5.3.5</span> Limitaciones y alternativas</a></li>
  </ul></li>
  <li><a href="#otros-glms" id="toc-otros-glms" class="nav-link" data-scroll-target="#otros-glms"><span class="header-section-number">5.4</span> Otros GLMs</a>
  <ul class="collapse">
  <li><a href="#regresión-binomial-negativa" id="toc-regresión-binomial-negativa" class="nav-link" data-scroll-target="#regresión-binomial-negativa"><span class="header-section-number">5.4.1</span> Regresión Binomial Negativa</a></li>
  <li><a href="#modelos-para-variables-continuas-no-normales" id="toc-modelos-para-variables-continuas-no-normales" class="nav-link" data-scroll-target="#modelos-para-variables-continuas-no-normales"><span class="header-section-number">5.4.2</span> Modelos para variables continuas No Normales</a></li>
  </ul></li>
  <li><a href="#comparación-de-modelos-y-evaluación-del-ajuste" id="toc-comparación-de-modelos-y-evaluación-del-ajuste" class="nav-link" data-scroll-target="#comparación-de-modelos-y-evaluación-del-ajuste"><span class="header-section-number">5.5</span> Comparación de modelos y evaluación del ajuste</a>
  <ul class="collapse">
  <li><a href="#la-deviance" id="toc-la-deviance" class="nav-link" data-scroll-target="#la-deviance"><span class="header-section-number">5.5.1</span> La Deviance</a></li>
  <li><a href="#criterios-de-selección-de-modelos-aic-bic" id="toc-criterios-de-selección-de-modelos-aic-bic" class="nav-link" data-scroll-target="#criterios-de-selección-de-modelos-aic-bic"><span class="header-section-number">5.5.2</span> Criterios de selección de modelos (AIC, BIC)</a></li>
  <li><a href="#validación-cruzada-y-técnicas-de-evaluación-predictiva" id="toc-validación-cruzada-y-técnicas-de-evaluación-predictiva" class="nav-link" data-scroll-target="#validación-cruzada-y-técnicas-de-evaluación-predictiva"><span class="header-section-number">5.5.3</span> Validación cruzada y técnicas de evaluación predictiva</a></li>
  <li><a href="#diagnóstico-de-residuos-y-buenas-prácticas" id="toc-diagnóstico-de-residuos-y-buenas-prácticas" class="nav-link" data-scroll-target="#diagnóstico-de-residuos-y-buenas-prácticas"><span class="header-section-number">5.5.4</span> Diagnóstico de residuos y buenas prácticas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tema4" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos de regresión generalizada</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Hasta ahora hemos estuadiado la regresión lineal como una herramienta poderosa para modelar la relación entre una variable dependiente continua y un conjunto de variables independientes. Sin embargo, en muchos contextos del mundo real, las suposiciones de la regresión lineal tradicional no son adecuadas. ¿Qué sucede si la variable dependiente es binaria, como en un diagnóstico médico (enfermo/sano)? ¿O si estás modelando el número de accidentes en una intersección o la cantidad de compras realizadas por un cliente?</p>
<p>Para abordar estos desafíos, se utilizan los llamados <strong>Modelos Lineales Generalizados (GLM)</strong>. Esta clase de modelos amplía la regresión lineal al permitir que la variable dependiente tenga distribuciones diferentes a la normal, como la binomial o la de Poisson. Además, los GLM utilizan funciones de enlace que transforman la relación entre la variable dependiente y los predictores, permitiendo una mayor flexibilidad en el modelado.</p>
<p>Algunos de los modelos más comunes dentro de los GLM son:</p>
<ul>
<li>Regresión Logística: Ideal para variables dependientes binarias (sí/no, éxito/fracaso).</li>
<li>Regresión de Poisson: Utilizada para modelar datos de conteo (número de eventos).</li>
<li>Regresión Binomial Negativa: Una extensión de la regresión de Poisson para datos de conteo con sobredispersión.</li>
<li>Modelos de Gamma y Inverso Gaussiano: Utilizados para modelar variables continuas positivas y sesgadas, como tiempos de espera o costos.</li>
</ul>
<p>En este tema, exploraremos cómo utilizar estos modelos para resolver problemas del mundo real, interpretar sus resultados y evaluar su ajuste.</p>
<section id="introducción-a-los-glm" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introducción-a-los-glm"><span class="header-section-number">5.1</span> Introducción a los GLM</h2>
<section id="qué-son-los-modelos-lineales-generalizados" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="qué-son-los-modelos-lineales-generalizados"><span class="header-section-number">5.1.1</span> ¿Qué son los Modelos Lineales Generalizados?</h3>
<p>Los <strong>Modelos Lineales Generalizados (GLM)</strong> son una extensión de los modelos de regresión lineal que permiten manejar una mayor variedad de tipos de datos y relaciones entre variables <span class="citation" data-cites="nelder1972generalized">(<a href="#ref-nelder1972generalized" role="doc-biblioref">Nelder y Wedderburn 1972</a>)</span>. Mientras que la regresión lineal tradicional asume que la variable dependiente es continua y sigue una distribución normal, los GLM permiten trabajar con variables dependientes que:</p>
<ul>
<li>Son <strong>binarias</strong> (como éxito/fracaso o sí/no).</li>
<li>Representan <strong>conteos</strong> de eventos (número de llamadas, accidentes, etc.).</li>
<li>Son <strong>continuas positivas</strong> y no siguen una distribución normal (como tiempos o costos).</li>
</ul>
<p>Los GLM proporcionan una estructura flexible para modelar la relación entre una o más variables independientes y una variable dependiente que sigue alguna distribución de la <strong>familia exponencial</strong> (binomial, Poisson, gamma, entre otras).</p>
</section>
<section id="componentes-de-un-modelo-lineal-generalizado" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="componentes-de-un-modelo-lineal-generalizado"><span class="header-section-number">5.1.2</span> Componentes de un Modelo Lineal Generalizado</h3>
<p>Un GLM se define por tres componentes clave:</p>
<ol type="1">
<li><p><strong>Componente Aleatorio:</strong></p>
<p>Este componente describe la distribución de la variable dependiente. En la regresión lineal, la variable dependiente sigue una distribución normal. En los GLM, puede seguir otras distribuciones de la <strong>familia exponencial</strong>, como:</p>
<ul>
<li><strong>Distribución Binomial:</strong> Para variables categóricas binarias (0/1, éxito/fracaso).</li>
<li><strong>Distribución de Poisson:</strong> Para datos de conteo (número de eventos).</li>
<li><strong>Distribución Gamma:</strong> Para variables continuas y positivas (como costos o tiempos).</li>
</ul></li>
<li><p><strong>Componente Sistemático:</strong><br>
Este componente describe cómo las variables independientes se combinan linealmente en el modelo. Se define como:</p>
<p><span class="math display">\[
\eta = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p
\]</span></p>
<p>Donde <span class="math inline">\(\eta\)</span> es el <strong>predictor lineal</strong> y <span class="math inline">\(\beta\)</span> representa los coeficientes del modelo.</p></li>
<li><p><strong>Función de Enlace:</strong><br>
La función de enlace conecta el componente sistemático con la media de la variable dependiente. Mientras que en la regresión lineal la relación es directa ($Y = $), en los GLM se utiliza una función de enlace <span class="math inline">\(g(\mu)\)</span> para transformar la media <span class="math inline">\(\mu\)</span> y ajustar diferentes tipos de datos.</p>
<p><span class="math display">\[
g(\mu) = \eta
\]</span></p></li>
</ol>
<p><strong>Ejemplos de funciones de enlace:</strong></p>
<ul>
<li><strong>Logística (Logit):</strong> Para la regresión logística, que modela la probabilidad de un evento. <span class="math display">\[
g(\mu) = \log\left(\frac{\mu}{1 - \mu}\right)
\]</span></li>
<li><strong>Logarítmica:</strong> Para la regresión de Poisson, que modela tasas de eventos. <span class="math display">\[
g(\mu) = \log(\mu)
\]</span></li>
<li><strong>Identidad:</strong> Para la regresión lineal estándar. <span class="math display">\[
g(\mu) = \mu
\]</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Aplicaciones">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aplicaciones
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Los GLM se utilizan en una amplia variedad de disciplinas para resolver problemas del mundo real:</p>
<p><strong>Regresión Logística (para variables binarias):</strong></p>
<ul>
<li><strong>Medicina:</strong> Predicción de la presencia o ausencia de una enfermedad basada en factores de riesgo.</li>
<li><strong>Marketing:</strong> Determinación de la probabilidad de que un cliente compre un producto.</li>
<li><strong>Finanzas:</strong> Evaluación de la probabilidad de incumplimiento de pago de un préstamo.</li>
</ul>
<p><strong>Regresión de Poisson (para datos de conteo):</strong></p>
<ul>
<li><strong>Transporte:</strong> Modelado del número de accidentes en una carretera en un período de tiempo.</li>
<li><strong>Ecología:</strong> Conteo de especies en un área determinada.</li>
<li><strong>Telecomunicaciones:</strong> Número de llamadas recibidas por un centro de atención.</li>
</ul>
<p><strong>Regresión Binomial Negativa (para conteos con sobredispersión):</strong></p>
<ul>
<li><strong>Salud Pública:</strong> Modelado del número de visitas al médico o incidentes de una enfermedad en una población.</li>
</ul>
<p><strong>Modelos Gamma (para variables continuas positivas):</strong></p>
<ul>
<li><strong>Seguros:</strong> Estimación de los costos de reclamos de seguros.</li>
<li><strong>Ingeniería:</strong> Modelado de tiempos de falla en procesos industriales.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="diferencias-clave-entre-la-regresión-lineal-y-los-glm" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="diferencias-clave-entre-la-regresión-lineal-y-los-glm"><span class="header-section-number">5.1.3</span> Diferencias clave entre la Regresión Lineal y los GLM</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 39%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Característica</strong></th>
<th><strong>Regresión Lineal</strong></th>
<th><strong>Modelos Lineales Generalizados (GLM)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Distribución de la variable dependiente</strong></td>
<td>Normal</td>
<td>Familia exponencial (binomial, Poisson, gamma, etc.)</td>
</tr>
<tr class="even">
<td><strong>Tipo de variable dependiente</strong></td>
<td>Continua</td>
<td>Binaria, de conteo, continua positiva</td>
</tr>
<tr class="odd">
<td><strong>Relación entre las variables</strong></td>
<td>Lineal directa</td>
<td>Relación transformada mediante una función de enlace</td>
</tr>
<tr class="even">
<td><strong>Función de Enlace</strong></td>
<td>Identidad (<span class="math inline">\(g(\mu) = \mu\)</span>)</td>
<td>Logit, logarítmica, inversa, etc.</td>
</tr>
</tbody>
</table>
<hr>
<p>Las ventajas principales de los GLM son:</p>
<ul>
<li><p><strong>Flexibilidad:</strong> Los GLM permiten modelar diferentes tipos de variables dependientes, lo que amplía significativamente el rango de problemas que se pueden abordar.</p></li>
<li><p><strong>Interpretación Coherente:</strong> Aunque se utilizan funciones de enlace, los coeficientes de los GLM pueden interpretarse de manera similar a los modelos lineales, proporcionando información sobre el impacto de cada variable independiente.</p></li>
<li><p><strong>Evaluación Estadística Robusta:</strong> Los GLM permiten la realización de pruebas de hipótesis, la construcción de intervalos de confianza y la evaluación de la bondad del ajuste mediante medidas como el <strong>AIC</strong> y el <strong>BIC</strong>.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librería y datos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Pima.tr)  <span class="co"># Datos sobre diabetes en mujeres de origen pima</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar un modelo de regresión logística</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>modelo_logistico <span class="ot">&lt;-</span> <span class="fu">glm</span>(type <span class="sc">~</span> npreg <span class="sc">+</span> glu <span class="sc">+</span> bmi, <span class="at">data =</span> Pima.tr, <span class="at">family =</span> binomial)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_logistico)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = type ~ npreg + glu + bmi, family = binomial, data = Pima.tr)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -8.718723   1.411080  -6.179 6.46e-10 ***
npreg        0.149213   0.051833   2.879  0.00399 ** 
glu          0.033879   0.006327   5.355 8.55e-08 ***
bmi          0.094817   0.032405   2.926  0.00343 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 256.41  on 199  degrees of freedom
Residual deviance: 189.89  on 196  degrees of freedom
AIC: 197.89

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones de la probabilidad de tener diabetes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_logistico, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver primeras predicciones</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicciones)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3          4          5          6 
0.10014804 0.78786795 0.12244031 0.80425012 0.06975347 0.21233644 </code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<p>Los <strong>Modelos Lineales Generalizados</strong> amplían el alcance de la regresión lineal clásica, proporcionando herramientas para modelar una amplia variedad de tipos de datos, desde variables binarias hasta datos de conteo y variables continuas no normales. A través del uso de funciones de enlace y distribuciones flexibles, los GLM permiten resolver problemas complejos del mundo real en campos tan diversos como la medicina, el marketing, la ingeniería y las ciencias sociales.</p>
<p>En las próximas secciones, exploraremos en detalle cómo aplicar estos modelos específicos, como la <strong>regresión logística</strong> y la <strong>regresión de Poisson</strong>, y cómo interpretar sus resultados en diferentes contextos.</p>
</section>
</section>
<section id="regresión-logística" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="regresión-logística"><span class="header-section-number">5.2</span> Regresión Logística</h2>
<p>La <strong>regresión logística</strong> es una herramienta fundamental para modelar la probabilidad de eventos binarios en una variedad de contextos, desde la medicina hasta la economía y el marketing <span class="citation" data-cites="hosmer2013applied">(<a href="#ref-hosmer2013applied" role="doc-biblioref">Hosmer Jr, Lemeshow, y Sturdivant 2013</a>)</span>. La correcta interpretación de los coeficientes mediante <strong>odds ratios</strong>, así como la evaluación del ajuste del modelo mediante curvas <strong>ROC</strong> y matrices de confusión, son esenciales para extraer conclusiones válidas de los datos.</p>
<section id="fundamentos-de-la-regresión-logística" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="fundamentos-de-la-regresión-logística"><span class="header-section-number">5.2.1</span> Fundamentos de la Regresión Logística</h3>
<p>La <strong>regresión logística</strong> es una técnica estadística utilizada para modelar la probabilidad de ocurrencia de un evento binario, es decir, cuando la variable dependiente toma solo dos posibles valores (por ejemplo, <strong>éxito/fracaso</strong>, <strong>sí/no</strong>, <strong>enfermo/sano</strong>). A diferencia de la regresión lineal, que modela una relación lineal entre variables, la regresión logística utiliza una <strong>función logística</strong> para asegurar que las predicciones estén en el rango [0,1], lo cual es necesario para interpretar los resultados como probabilidades.</p>
<p><strong>La función Logística (Sigmoide)</strong></p>
<p>La función logística transforma cualquier valor real en un valor comprendido entre 0 y 1. La forma matemática de la función logística es:</p>
<p><span class="math display">\[
P(Y = 1 | X) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p)}}
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(P(Y = 1 | X)\)</span> es la probabilidad de que el evento ocurra.</li>
<li><span class="math inline">\(\beta_0\)</span> es el intercepto y <span class="math inline">\(\beta_1, \beta_2, \dots, \beta_p\)</span> son los coeficientes asociados a las variables independientes <span class="math inline">\(X_1, X_2, \dots, X_p\)</span>.</li>
</ul>
<p>La <strong>curva sigmoide</strong> que representa esta función tiene forma de “S”, lo que refleja que para valores muy pequeños o muy grandes del predictor, la probabilidad se aplana hacia 0 o 1, respectivamente.</p>
<p><strong>Función de Enlace Logit</strong></p>
<p>En la regresión logística, la relación entre el predictor lineal y la probabilidad se establece mediante la <strong>función de enlace logit</strong>. El logit de una probabilidad <span class="math inline">\(p\)</span> se define como:</p>
<p><span class="math display">\[
\text{logit}(p) = \log\left(\frac{p}{1 - p}\right)
\]</span></p>
<p>Esta transformación convierte una probabilidad en una escala que va de <span class="math inline">\(-\infty\)</span> a <span class="math inline">\(+\infty\)</span>, lo que permite ajustar un modelo lineal a los datos. El modelo logístico puede expresarse como:</p>
<p><span class="math display">\[
\log\left(\frac{p}{1 - p}\right) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p
\]</span></p>
</section>
<section id="interpretación-de-coeficientes-y-odds-ratios" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="interpretación-de-coeficientes-y-odds-ratios"><span class="header-section-number">5.2.2</span> Interpretación de coeficientes y Odds Ratios</h3>
<p>Uno de los aspectos más importantes de la regresión logística es la interpretación de los coeficientes. Dado que los coeficientes están en la escala del logit, su interpretación directa no es tan intuitiva como en la regresión lineal. Sin embargo, podemos interpretarlos utilizando <strong>odds</strong> y <strong>odds ratios</strong>.</p>
<p>El <strong>odds</strong> o razón de probabilidades de que ocurra un evento es el cociente entre la probabilidad de que ocurra el evento y la probabilidad de que no ocurra:</p>
<p><span class="math display">\[
\text{odds} = \frac{p}{1 - p}
\]</span></p>
<p>Por ejemplo, si la probabilidad de éxito es 0.8, el odds sería:</p>
<p><span class="math display">\[
\text{odds} = \frac{0.8}{1 - 0.8} = 4
\]</span></p>
<p>Esto significa que el evento es <strong>4 veces más probable</strong> que no ocurra.</p>
<p>El <strong>odds ratio (OR)</strong> mide el cambio en los odds cuando una variable independiente aumenta en una unidad. Se calcula como el exponencial del coeficiente de la regresión logística:</p>
<p><span class="math display">\[
\text{OR} = e^{\beta}
\]</span></p>
<p><strong>Interpretación de OR:</strong></p>
<ul>
<li>Si <strong>OR &gt; 1</strong>, el evento es más probable a medida que aumenta la variable independiente.</li>
<li>Si <strong>OR &lt; 1</strong>, el evento es menos probable a medida que aumenta la variable independiente.</li>
<li>Si <strong>OR = 1</strong>, no hay efecto.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supongamos que ajustamos un modelo de regresión logística para predecir la probabilidad de tener diabetes en función del índice de masa corporal (BMI). El coeficiente asociado a <strong>BMI</strong> es 0.08.</p>
<p><span class="math display">\[
\text{OR} = e^{0.08} \approx 1.083
\]</span></p>
<p>Esto significa que por cada incremento de 1 unidad en el BMI, la <strong>odds</strong> de tener diabetes aumentan en un <strong>8.3%</strong>.</p>
</div>
</div>
</div>
</section>
<section id="evaluación-del-modelo-logístico" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="evaluación-del-modelo-logístico"><span class="header-section-number">5.2.3</span> Evaluación del modelo Logístico</h3>
<p>A diferencia de la regresión lineal, donde se usa el coeficiente de determinación (<span class="math inline">\(R^2\)</span>) para evaluar el ajuste, en la regresión logística se utilizan otros métodos para medir la calidad del modelo.</p>
<p><strong>Matriz de Confusión</strong></p>
<p>La <strong>matriz de confusión</strong> compara las predicciones del modelo con los valores reales, clasificando las observaciones en:</p>
<ul>
<li><strong>Verdaderos Positivos (VP):</strong> Predijo positivo y es positivo.</li>
<li><strong>Falsos Positivos (FP):</strong> Predijo positivo pero es negativo.</li>
<li><strong>Verdaderos Negativos (VN):</strong> Predijo negativo y es negativo.</li>
<li><strong>Falsos Negativos (FN):</strong> Predijo negativo pero es positivo.</li>
</ul>
<p>A partir de esta matriz, se pueden calcular métricas importantes como:</p>
<ul>
<li><strong>Precisión (Accuracy):</strong> <span class="math inline">\(\frac{VP + VN}{\text{Total}}\)</span></li>
<li><strong>Sensibilidad (Recall o Tasa de Verdaderos Positivos):</strong> <span class="math inline">\(\frac{VP}{VP + FN}\)</span></li>
<li><strong>Especificidad (Tasa de Verdaderos Negativos):</strong> <span class="math inline">\(\frac{VN}{VN + FP}\)</span></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled" title="Aviso">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aviso
</div>
</div>
<div class="callout-body-container callout-body">
<p>Los detalles de la evaluación de un modelo empleando la Matríz de Confusión son ampliamente tratados en la asignatura de Aprendizaje Automático.</p>
</div>
</div>
<p><strong>Curva ROC y AUC</strong></p>
<p>La <strong>Curva ROC (Receiver Operating Characteristic)</strong> muestra la relación entre la <strong>tasa de verdaderos positivos</strong> y la <strong>tasa de falsos positivos</strong> a diferentes umbrales de clasificación.</p>
<p>El <strong>AUC (Área Bajo la Curva ROC)</strong> mide la capacidad del modelo para discriminar entre las clases. Un AUC de <span class="math inline">\(0.5\)</span> indica que el modelo no tiene capacidad predictiva, mientras que un AUC de <span class="math inline">\(1.0\)</span> indica un modelo perfecto.</p>
<p><strong>Pseudo R² (Nagelkerke, McFadden)</strong></p>
<p>Aunque el <span class="math inline">\(R^2\)</span> tradicional no se aplica directamente a la regresión logística, existen medidas como el <strong>pseudo <span class="math inline">\(R^2\)</span></strong> que proporcionan una idea de la bondad del ajuste del modelo.</p>
<ul>
<li><p><strong>McFadden’s <span class="math inline">\(R^2\)</span>:</strong><br>
<span class="math display">\[
R^2_{\text{McFadden}} = 1 - \frac{\log L_{\text{modelo}}}{\log L_{\text{modelo nulo}}}
\]</span></p>
<p>Donde <span class="math inline">\(\log L_{\text{modelo}}\)</span> es el log-likelihood del modelo ajustado y <span class="math inline">\(\log L_{\text{modelo nulo}}\)</span> es el log-likelihood de un modelo sin predictores.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a aplicar la regresión logística en R utilizando el conjunto de datos <code>Pima.tr</code> del paquete <code>MASS</code>, que contiene información sobre mujeres pima y si tienen o no diabetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la librería y el conjunto de datos</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Pima.tr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo de regresión logística</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>modelo_logistico <span class="ot">&lt;-</span> <span class="fu">glm</span>(type <span class="sc">~</span> npreg <span class="sc">+</span> glu <span class="sc">+</span> bmi, <span class="at">data =</span> Pima.tr, <span class="at">family =</span> binomial)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_logistico)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = type ~ npreg + glu + bmi, family = binomial, data = Pima.tr)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -8.718723   1.411080  -6.179 6.46e-10 ***
npreg        0.149213   0.051833   2.879  0.00399 ** 
glu          0.033879   0.006327   5.355 8.55e-08 ***
bmi          0.094817   0.032405   2.926  0.00343 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 256.41  on 199  degrees of freedom
Residual deviance: 189.89  on 196  degrees of freedom
AIC: 197.89

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones de probabilidad</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>predicciones_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_logistico, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clasificación con un umbral de 0.5</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>predicciones_clase <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicciones_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear matriz de confusión</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>tabla_confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> predicciones_clase, <span class="at">Actual =</span> Pima.tr<span class="sc">$</span>type)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_confusion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted  No Yes
      No  114  29
      Yes  18  39</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular precisión</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(tabla_confusion)) <span class="sc">/</span> <span class="fu">sum</span>(tabla_confusion)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Precisión:"</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Precisión: 0.765"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librería para curvas ROC</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Curva ROC</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(Pima.tr<span class="sc">$</span>type, predicciones_prob)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">main =</span> <span class="st">"Curva ROC para Regresión Logística"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema4_files/figure-html/log1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular AUC</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>auc_valor <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC:"</span>, <span class="fu">round</span>(auc_valor, <span class="dv">3</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC: 0.831"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="regresión-de-poisson" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="regresión-de-poisson"><span class="header-section-number">5.3</span> Regresión de Poisson</h2>
<p>La <strong>regresión de Poisson</strong> es una técnica estadística utilizada para modelar <strong>datos de conteo</strong>, es decir, situaciones en las que la variable dependiente representa el número de veces que ocurre un evento en un período de tiempo o espacio específico <span class="citation" data-cites="coxe2009analysis">(<a href="#ref-coxe2009analysis" role="doc-biblioref">Coxe, West, y Aiken 2009</a>)</span>. Este tipo de modelo es adecuado cuando la variable dependiente toma valores enteros no negativos (<span class="math inline">\(0, 1, 2, \dots\)</span>) y sigue una distribución de <strong>Poisson</strong>.</p>
<p>La distribución de Poisson describe la probabilidad de que ocurra un número determinado de eventos en un intervalo fijo, dado que estos eventos ocurren de forma independiente y a una tasa constante.</p>
<p>La <strong>función de probabilidad</strong> de la distribución de Poisson es:</p>
<p><span class="math display">\[
P(Y = y) = \frac{e^{-\lambda} \lambda^y}{y!}
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(Y\)</span> es la variable aleatoria que representa el número de eventos.</li>
<li><span class="math inline">\(\lambda\)</span> es la <strong>tasa media de ocurrencia</strong> de los eventos (esperanza de <span class="math inline">\(Y\)</span>).</li>
<li><span class="math inline">\(y\)</span> es el número de eventos observados (<span class="math inline">\(y = 0, 1, 2, \dots\)</span>).</li>
</ul>
<section id="modelo-de-regresión-de-poisson" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="modelo-de-regresión-de-poisson"><span class="header-section-number">5.3.1</span> Modelo de regresión de Poisson</h3>
<p>En la <strong>regresión de Poisson</strong>, el objetivo es modelar la relación entre la <strong>tasa de ocurrencia de los eventos</strong> (<span class="math inline">\(\lambda\)</span>) y un conjunto de variables predictoras <span class="math inline">\(X_1, X_2, \dots, X_p\)</span>.</p>
<p>La <strong>forma funcional</strong> del modelo de Poisson es:</p>
<p><span class="math display">\[
\log(\lambda) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(\log(\lambda)\)</span> es la <strong>función de enlace logarítmica</strong> que asegura que la tasa <span class="math inline">\(\lambda\)</span> sea siempre positiva.</li>
<li><span class="math inline">\(\beta_0, \beta_1, \dots, \beta_p\)</span> son los coeficientes del modelo que describen la influencia de cada predictor sobre la tasa de eventos.</li>
</ul>
<p>El modelo puede expresarse en términos de la <strong>tasa esperada de eventos</strong> como:</p>
<p><span class="math display">\[
\lambda = e^{\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p}
\]</span></p>
</section>
<section id="supuestos-y-limitaciones-de-la-regresión-de-poisson" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="supuestos-y-limitaciones-de-la-regresión-de-poisson"><span class="header-section-number">5.3.2</span> Supuestos y limitaciones de la regresión de Poisson</h3>
<p>Tal y como ocurre en el modelo de regresión lineal, para que la regresión de Poisson sea adecuada, se deben cumplir ciertos <strong>supuestos</strong>:</p>
<ul>
<li><p><strong>Independencia de los eventos:</strong> Los eventos deben ocurrir de manera independiente unos de otros.</p></li>
<li><p><strong>Distribución de Poisson de la variable dependiente:</strong> La variable de respuesta debe seguir una distribución de Poisson, donde la <strong>media</strong> y la <strong>varianza</strong> son iguales:</p></li>
</ul>
<p><span class="math display">\[
   E(Y) = Var(Y) = \lambda
   \]</span></p>
<ul>
<li><p><strong>No sobredispersión:</strong> Uno de los problemas comunes en los datos de conteo es la <strong>sobredispersión</strong>, que ocurre cuando la varianza de los datos es mayor que la media (<span class="math inline">\(Var(Y) &gt; E(Y)\)</span>). La presencia de sobredispersión indica que el modelo de Poisson puede no ser adecuado, y puede ser necesario considerar modelos alternativos como la <strong>regresión binomial negativa</strong>.</p></li>
<li><p><strong>No exceso de ceros:</strong> Si hay demasiados ceros en los datos (por ejemplo, en el número de accidentes en diferentes localidades donde muchas tienen cero accidentes), puede ser necesario utilizar modelos de <strong>Poisson inflados en ceros (ZIP)</strong> <span class="citation" data-cites="lambert1992zero">(<a href="#ref-lambert1992zero" role="doc-biblioref">Lambert 1992</a>)</span>.</p></li>
</ul>
</section>
<section id="interpretación-de-los-resultados" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="interpretación-de-los-resultados"><span class="header-section-number">5.3.3</span> Interpretación de los resultados</h3>
<p>La interpretación de los coeficientes en la regresión de Poisson difiere de la regresión lineal debido al uso de la función de enlace logarítmica.</p>
<p>Los coeficientes <span class="math inline">\(\beta\)</span> representan el <strong>logaritmo de la tasa</strong> de eventos asociados con un cambio en la variable independiente. Para interpretar en términos de la tasa de ocurrencia, se utiliza el <strong>exponencial de los coeficientes</strong>:</p>
<p><span class="math display">\[
  e^{\beta_i}
\]</span></p>
<p>Esto representa el <strong>factor de cambio multiplicativo</strong> en la tasa de eventos por cada unidad adicional en la variable <span class="math inline">\(X_i\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Si <span class="math inline">\(\beta_1 = 0.5\)</span>, entonces <span class="math inline">\(e^{0.5} \approx 1.65\)</span>. Esto significa que por cada unidad adicional en <span class="math inline">\(X_1\)</span>, la tasa de ocurrencia de eventos <strong>aumenta en un 65%</strong>.</p>
<p>Si <span class="math inline">\(\beta_1 = -0.3\)</span>, entonces <span class="math inline">\(e^{-0.3} \approx 0.74\)</span>. Esto indica que por cada unidad adicional en <span class="math inline">\(X_1\)</span>, la tasa de eventos <strong>disminuye en un 26%</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a utilizar R para ajustar un modelo de regresión de Poisson. Supongamos que tenemos datos sobre el <strong>número de accidentes de tráfico</strong> en diferentes intersecciones de una ciudad, junto con variables como el volumen de tráfico y la visibilidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de datos para el número de accidentes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Número de observaciones</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables predictoras</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>trafico <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="dv">300</span>)  <span class="co"># Volumen de tráfico en vehículos por día</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>visibilidad <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)   <span class="co"># Visibilidad en kilómetros</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar la tasa de accidentes (lambda) usando un modelo logarítmico</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.01</span> <span class="sc">*</span> trafico <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> visibilidad)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el número de accidentes como una variable de Poisson</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>accidentes <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> lambda)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el data frame</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>datos_accidentes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(accidentes, trafico, visibilidad)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos_accidentes)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  accidentes   trafico visibilidad
1       2102  831.8573    3.579187
2       3744  930.9468    5.513767
3     959848 1467.6125    4.506616
4      11356 1021.1525    4.304915
5      17411 1038.7863    3.096763
6    1415794 1514.5195    4.909945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo de regresión de Poisson</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>modelo_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(accidentes <span class="sc">~</span> trafico <span class="sc">+</span> visibilidad, <span class="at">data =</span> datos_accidentes, <span class="at">family =</span> poisson)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_poisson)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = accidentes ~ trafico + visibilidad, family = poisson, 
    data = datos_accidentes)

Coefficients:
              Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept) -1.610e-03  2.116e-03    -0.761    0.447    
trafico      1.000e-02  1.323e-06  7557.681   &lt;2e-16 ***
visibilidad -2.001e-01  1.025e-04 -1951.765   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1.2621e+08  on 99  degrees of freedom
Residual deviance: 9.5511e+01  on 97  degrees of freedom
AIC: 1216.4

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<p>El coeficiente asociado a <code>trafico</code> indica cómo el volumen de tráfico afecta la tasa de accidentes.</p>
<p>El coeficiente asociado a <code>visibilidad</code> muestra cómo la visibilidad afecta la frecuencia de accidentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponenciar los coeficientes para interpretar en términos de tasas</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(modelo_poisson))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     trafico visibilidad 
  0.9983910   1.0100516   0.8186814 </code></pre>
</div>
</div>
<p>Un coeficiente positivo implica que un aumento en la variable está asociado con un <strong>aumento en la tasa de accidentes</strong>.</p>
<p>Un coeficiente negativo implica que un aumento en la variable está asociado con una <strong>disminución en la tasa de accidentes</strong>.</p>
</div>
</div>
</div>
</section>
<section id="evaluación-del-modelo-de-poisson" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="evaluación-del-modelo-de-poisson"><span class="header-section-number">5.3.4</span> Evaluación del modelo de Poisson</h3>
<p>La <strong>sobredispersión</strong> ocurre cuando la varianza de los datos es mayor que la media, lo que puede invalidar los supuestos de la regresión de Poisson.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la relación entre el deviance y los grados de libertad</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>deviance <span class="ot">&lt;-</span> modelo_poisson<span class="sc">$</span>deviance</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>grados_libertad <span class="ot">&lt;-</span> modelo_poisson<span class="sc">$</span>df.residual</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>sobredispersion <span class="ot">&lt;-</span> deviance <span class="sc">/</span> grados_libertad</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Índice de Sobredispersión:"</span>, <span class="fu">round</span>(sobredispersion, <span class="dv">2</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Índice de Sobredispersión: 0.98"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Un valor del índice de sobredispersión cercano a <span class="math inline">\(1\)</span> sugiere que no hay sobredispersión. Por contra, un valor significativamente mayor que <span class="math inline">\(1\)</span> sugiere la presencia de sobredispersión, y puede ser necesario considerar una <strong>regresión binomial negativa</strong>.</p>
<p><strong>Diagnóstico de Residuos:</strong></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de residuos deviance para evaluar el ajuste</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(modelo_poisson, <span class="at">type =</span> <span class="st">"deviance"</span>), <span class="at">main =</span> <span class="st">"Residuos Deviance"</span>, <span class="at">ylab =</span> <span class="st">"Residuos"</span>, <span class="at">xlab =</span> <span class="st">"Índice"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema4_files/figure-html/diag1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo sobre datos reales">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo sobre datos reales
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Un conjunto de datos clásico en R es <strong><code>warpbreaks</code></strong>, que contiene el número de roturas de hilo en diferentes condiciones de tensión y longitud del hilo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo: número de roturas de hilo</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(warpbreaks)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar un modelo de Poisson para el número de roturas en función de la tensión</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>modelo_poisson_real <span class="ot">&lt;-</span> <span class="fu">glm</span>(breaks <span class="sc">~</span> wool <span class="sc">+</span> tension, <span class="at">data =</span> warpbreaks, <span class="at">family =</span> poisson)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_poisson_real)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = breaks ~ wool + tension, family = poisson, data = warpbreaks)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.69196    0.04541  81.302  &lt; 2e-16 ***
woolB       -0.20599    0.05157  -3.994 6.49e-05 ***
tensionM    -0.32132    0.06027  -5.332 9.73e-08 ***
tensionH    -0.51849    0.06396  -8.107 5.21e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 297.37  on 53  degrees of freedom
Residual deviance: 210.39  on 50  degrees of freedom
AIC: 493.06

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretación de coeficientes</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(modelo_poisson_real))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       woolB    tensionM    tensionH 
 40.1235380   0.8138425   0.7251908   0.5954198 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="limitaciones-y-alternativas" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="limitaciones-y-alternativas"><span class="header-section-number">5.3.5</span> Limitaciones y alternativas</h3>
<p>Si la varianza de los datos es mayor que la media, el modelo de Poisson no será adecuado. En este caso, se recomienda utilizar la <strong>regresión binomial negativa</strong>, que introduce un parámetro adicional para manejar la sobredispersión.</p>
<p>Si hay más ceros de los esperados (por ejemplo, muchas intersecciones con cero accidentes), puede ser necesario utilizar modelos de <strong>Poisson inflados en ceros (ZIP)</strong> o <strong>binomial negativa inflada en ceros (ZINB)</strong>.</p>
</section>
</section>
<section id="otros-glms" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="otros-glms"><span class="header-section-number">5.4</span> Otros GLMs</h2>
<p>La <strong>regresión binomial negativa</strong> y los <strong>modelos basados en distribuciones como Gamma e Inversa Gaussiana</strong> amplían la capacidad de los <strong>Modelos Lineales Generalizados (GLM)</strong> para adaptarse a una amplia variedad de situaciones del mundo real. Estos modelos son especialmente útiles cuando los datos presentan características como sobredispersión, sesgo o restricciones en el dominio (por ejemplo, solo valores positivos). La elección adecuada del modelo y la función de enlace garantiza predicciones precisas y válidas, contribuyendo a la toma de decisiones informadas en campos como la salud, la ingeniería y la economía.</p>
<section id="regresión-binomial-negativa" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="regresión-binomial-negativa"><span class="header-section-number">5.4.1</span> Regresión Binomial Negativa</h3>
<p>Tal y como hemos visto en apartados anteriores, la <strong>sobredispersión</strong> ocurre cuando la varianza de los datos de conteo es <strong>mayor que la media</strong>, lo cual viola uno de los supuestos clave de la regresión de Poisson, que asume que la media y la varianza son iguales (<span class="math inline">\(E(Y) = Var(Y)\)</span>). La sobredispersión puede surgir por varias razones:</p>
<ul>
<li><strong>Heterogeneidad no modelada:</strong> Existen factores que afectan la variable dependiente pero no han sido incluidos en el modelo.</li>
<li><strong>Dependencia entre eventos:</strong> Los eventos no ocurren de forma independiente.</li>
<li><strong>Exceso de ceros:</strong> Hay más ceros en los datos de los que predice la distribución de Poisson.</li>
</ul>
<p>Cuando la sobredispersión está presente, la regresión de Poisson subestima los errores estándar, lo que puede llevar a conclusiones incorrectas sobre la significancia de los predictores.</p>
<p>La <strong>regresión binomial negativa</strong> es una extensión de la regresión de Poisson que introduce un parámetro adicional para manejar la sobredispersión. Este modelo permite que la varianza sea mayor que la media:</p>
<p><span class="math display">\[
Var(Y) = \lambda + \alpha \lambda^2
\]</span></p>
<p>Donde <span class="math inline">\(\alpha\)</span> es el parámetro de dispersión. Si <span class="math inline">\(\alpha = 0\)</span>, el modelo se reduce a la regresión de Poisson.</p>
<p>La forma funcional del modelo binomial negativa es similar al de Poisson:</p>
<p><span class="math display">\[
\log(\lambda) = \beta_0 + \beta_1 X_1 + \dots + \beta_p X_p
\]</span></p>
<p>Pero la varianza ahora incluye el término adicional <span class="math inline">\(\alpha\)</span> para capturar la sobredispersión.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar y cargar la librería MASS que contiene la función glm.nb</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de un modelo binomial negativo con los datos simulados de accidentes</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>modelo_binom_neg <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(accidentes <span class="sc">~</span> trafico <span class="sc">+</span> visibilidad, <span class="at">data =</span> datos_accidentes)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in glm.nb(accidentes ~ trafico + visibilidad, data = datos_accidentes):
alternation limit reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_binom_neg)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = accidentes ~ trafico + visibilidad, data = datos_accidentes, 
    init.theta = 245462679.3, link = log)

Coefficients:
              Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept) -1.620e-03  2.122e-03    -0.763    0.445    
trafico      1.000e-02  1.329e-06  7523.491   &lt;2e-16 ***
visibilidad -2.001e-01  1.036e-04 -1931.079   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(245406071) family taken to be 1)

    Null deviance: 1.2568e+08  on 99  degrees of freedom
Residual deviance: 9.5469e+01  on 97  degrees of freedom
AIC: 1218.5

Number of Fisher Scoring iterations: 1

              Theta:  245462679 
          Std. Err.:  488358373 
Warning while fitting theta: alternation limit reached 

 2 x log-likelihood:  -1210.497 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar la dispersión con el modelo de Poisson</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dispersión en Poisson:"</span>, modelo_poisson<span class="sc">$</span>deviance <span class="sc">/</span> modelo_poisson<span class="sc">$</span>df.residual, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dispersión en Poisson: 0.9846515 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dispersión en Binomial Negativa:"</span>, modelo_binom_neg<span class="sc">$</span>theta, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dispersión en Binomial Negativa: 245462679 </code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>El parámetro <span class="math inline">\(\theta\)</span> (dispersión) ajustado en el modelo binomial negativa ayuda a corregir la varianza subestimada en el modelo de Poisson.</li>
<li>Si <span class="math inline">\(\theta\)</span> es significativamente mayor que 1, se confirma la presencia de sobredispersión.</li>
</ul>
<hr>
</section>
<section id="modelos-para-variables-continuas-no-normales" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="modelos-para-variables-continuas-no-normales"><span class="header-section-number">5.4.2</span> Modelos para variables continuas No Normales</h3>
<p>Existen situaciones en las que la variable dependiente es <strong>continua</strong>, pero <strong>no sigue una distribución normal</strong>. En estos casos, los <strong>Modelos Lineales Generalizados (GLM)</strong> permiten utilizar distribuciones alternativas como <strong>Gamma</strong> o <strong>Inversa Gaussiana</strong>, junto con funciones de enlace específicas.</p>
<section id="regresión-gamma-para-datos-positivos-y-sesgados" class="level4" data-number="5.4.2.1">
<h4 data-number="5.4.2.1" class="anchored" data-anchor-id="regresión-gamma-para-datos-positivos-y-sesgados"><span class="header-section-number">5.4.2.1</span> Regresión Gamma para datos positivos y sesgados</h4>
<p>La <strong>regresión Gamma</strong> es adecuada para modelar variables continuas que son <strong>positivas</strong> y tienen una distribución <strong>sesgada a la derecha</strong>. Ejemplos típicos incluyen tiempos de espera, costos médicos o duración de procesos.</p>
<ul>
<li>La distribución Gamma asume que la variable dependiente es continua y positiva.</li>
<li>La varianza de la variable dependiente aumenta proporcionalmente al cuadrado de la media.</li>
</ul>
<p><strong>Función de Enlace Común:</strong> <span class="math display">\[
\log(\mu) = \beta_0 + \beta_1 X_1 + \dots + \beta_p X_p
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de costos médicos</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ingresos <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50000</span>, <span class="at">sd =</span> <span class="dv">10000</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>edad <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>costos <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="fl">0.00005</span> <span class="sc">*</span> ingresos <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> edad)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo Gamma</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>modelo_gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(costos <span class="sc">~</span> ingresos <span class="sc">+</span> edad, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_gamma)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = costos ~ ingresos + edad, family = Gamma(link = "log"))

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  3.440e-01  5.294e-01   0.650   0.5173  
ingresos    -1.807e-05  7.804e-06  -2.316   0.0227 *
edad         3.584e-03  7.366e-03   0.487   0.6277  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.5010938)

    Null deviance: 60.771  on 99  degrees of freedom
Residual deviance: 58.345  on 97  degrees of freedom
AIC: 105.47

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<ul>
<li>Los coeficientes muestran cómo los ingresos y la edad afectan los costos médicos esperados.</li>
<li>El enlace logarítmico asegura que las predicciones sean siempre positivas.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="regresión-inversa-gaussiana" class="level4" data-number="5.4.2.2">
<h4 data-number="5.4.2.2" class="anchored" data-anchor-id="regresión-inversa-gaussiana"><span class="header-section-number">5.4.2.2</span> Regresión Inversa Gaussiana</h4>
<p>La <strong>regresión Inversa Gaussiana</strong> es útil para modelar tiempos de respuesta o variables donde la varianza disminuye rápidamente a medida que la media aumenta. Este modelo se aplica en campos como la ingeniería, donde se analizan tiempos hasta fallas de sistemas.</p>
<p><strong>Función de Enlace Común:</strong> <span class="math display">\[
\frac{1}{\mu^2} = \beta_0 + \beta_1 X_1 + \dots + \beta_p X_p
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar y cargar la librería correcta</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statmod)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de datos</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>carga_trabajo <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar tiempos hasta el fallo usando la distribución inversa gaussiana</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Aseguramos que los valores de carga_trabajo sean positivos para evitar problemas numéricos</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>carga_trabajo[carga_trabajo <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>tiempo_fallo <span class="ot">&lt;-</span> <span class="fu">rinvgauss</span>(n, <span class="at">mean =</span> <span class="dv">100</span> <span class="sc">/</span> carga_trabajo, <span class="at">dispersion =</span> <span class="dv">1</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo Inversa Gaussiana con enlace logarítmico</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>modelo_inversa_gauss <span class="ot">&lt;-</span> <span class="fu">glm</span>(tiempo_fallo <span class="sc">~</span> carga_trabajo, <span class="at">family =</span> <span class="fu">inverse.gaussian</span>(<span class="at">link =</span> <span class="st">"1/mu^2"</span>),<span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(eta): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: step size truncated due to divergence</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del modelo</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_inversa_gauss)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = tiempo_fallo ~ carga_trabajo, family = inverse.gaussian(link = "1/mu^2"), 
    start = c(0.01, 0.01))

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   -0.106143   0.462230  -0.230    0.819
carga_trabajo  0.008261   0.009623   0.859    0.393

(Dispersion parameter for inverse.gaussian family taken to be 1.348442)

    Null deviance: 94.085  on 99  degrees of freedom
Residual deviance: 93.171  on 98  degrees of freedom
AIC: 294.2

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="comparación-de-modelos-y-evaluación-del-ajuste" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="comparación-de-modelos-y-evaluación-del-ajuste"><span class="header-section-number">5.5</span> Comparación de modelos y evaluación del ajuste</h2>
<p>Una vez que se han ajustado varios modelos, es crucial evaluar su rendimiento y seleccionar el más adecuado para el problema en cuestión. La <strong>evaluación del ajuste</strong> y la <strong>comparación de modelos</strong> permiten identificar cuál modelo describe mejor los datos sin caer en el sobreajuste, es decir, ajustarse demasiado a los datos de entrenamiento a costa de un mal desempeño en datos nuevos.</p>
<p>Esta sección abordará los métodos más comunes para evaluar y comparar modelos, incluyendo criterios estadísticos, técnicas de validación y análisis de residuos.</p>
<section id="la-deviance" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="la-deviance"><span class="header-section-number">5.5.1</span> La Deviance</h3>
<p>La <strong>deviance</strong> (o <strong>desviación</strong>) es una medida estadística que evalúa qué tan bien se ajusta un modelo estadístico a los datos observados. Se utiliza principalmente en modelos de regresión que no se basan en supuestos de normalidad estricta, como los <strong>modelos lineales generalizados</strong> (GLM), incluyendo:</p>
<ul>
<li>Regresión logística</li>
<li>Regresión de Poisson</li>
<li>Modelos exponenciales, etc.</li>
</ul>
<p>La deviance mide la <strong>diferencia</strong> entre el modelo propuesto y el <strong>modelo saturado</strong> (el modelo que predice perfectamente los datos observados).</p>
<ul>
<li>El <strong>modelo saturado</strong> tiene tantos parámetros como observaciones, por lo que ajusta cada punto de datos perfectamente.</li>
<li>El <strong>modelo propuesto</strong> es el modelo que intentamos evaluar.</li>
</ul>
<p>La deviance se interpreta como una generalización de la <strong>suma de cuadrados de los residuos</strong> utilizada en regresión lineal.</p>
<p>La deviance se define como:</p>
<p><span class="math display">\[
D = 2 \sum_{i=1}^{n} \left[ \ell(y_i; y_i) - \ell(y_i; \hat{y}_i) \right]
\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(D\)</span> = Deviance</li>
<li><span class="math inline">\(\ell(y_i; y_i)\)</span> = Log-verosimilitud del modelo saturado (máxima verosimilitud posible)</li>
<li><span class="math inline">\(\ell(y_i; \hat{y}_i)\)</span> = Log-verosimilitud del modelo propuesto</li>
</ul>
<p>En términos simples, mide cuánto peor es el modelo propuesto comparado con el modelo que se ajusta perfectamente.</p>
<section id="interpretación" class="level4" data-number="5.5.1.1">
<h4 data-number="5.5.1.1" class="anchored" data-anchor-id="interpretación"><span class="header-section-number">5.5.1.1</span> Interpretación</h4>
<ul>
<li><strong>Valores pequeños de deviance</strong> → Indican que el modelo se ajusta bien a los datos.</li>
<li><strong>Valores grandes de deviance</strong> → Indican que el modelo no se ajusta bien.</li>
</ul>
<p>Si el modelo es perfecto, la deviance es <strong>cero</strong>.</p>
</section>
<section id="deviance-residuals" class="level4" data-number="5.5.1.2">
<h4 data-number="5.5.1.2" class="anchored" data-anchor-id="deviance-residuals"><span class="header-section-number">5.5.1.2</span> Deviance Residuals</h4>
<p>En lugar de evaluar la deviance global, los <strong>residuos de deviance</strong> permiten identificar qué observaciones individuales no se ajustan bien.</p>
<p><span class="math display">\[
d_i = \text{sign}(y_i - \hat{y}_i) \sqrt{2 \left[ \ell(y_i; y_i) - \ell(y_i; \hat{y}_i) \right]}
\]</span></p>
<p>Los residuos de deviance se comportan de forma similar a los residuos en regresión lineal, permitiendo identificar observaciones atípicas o mal ajustadas.</p>
</section>
<section id="relación-con-otros-conceptos" class="level4" data-number="5.5.1.3">
<h4 data-number="5.5.1.3" class="anchored" data-anchor-id="relación-con-otros-conceptos"><span class="header-section-number">5.5.1.3</span> Relación con otros conceptos</h4>
<ul>
<li>En <strong>regresión lineal</strong>, la deviance es equivalente a la <strong>suma de los cuadrados de los residuos</strong> (RSS).</li>
<li>En <strong>regresión logística</strong>, la deviance se utiliza como alternativa a la suma de errores cuadráticos debido a que los residuos no se distribuyen normalmente.</li>
<li>En <strong>pruebas de bondad de ajuste</strong>, se usa la <strong>deviance nula</strong> para comparar el modelo sin predictores (solo la media) con el modelo completo.</li>
</ul>
</section>
<section id="ejemplo-en-regresión-logística" class="level4" data-number="5.5.1.4">
<h4 data-number="5.5.1.4" class="anchored" data-anchor-id="ejemplo-en-regresión-logística"><span class="header-section-number">5.5.1.4</span> Ejemplo en Regresión Logística</h4>
<p>Supongamos que estamos modelando la probabilidad de que una persona compre un producto en función de su edad. La deviance nos ayuda a evaluar qué tan bien el modelo logra predecir esas probabilidades comparado con un modelo perfecto.</p>
<ul>
<li><strong>Deviance baja:</strong> El modelo ajusta bien las probabilidades.</li>
<li><strong>Deviance alta:</strong> El modelo falla en capturar los patrones en los datos.</li>
</ul>
</section>
</section>
<section id="criterios-de-selección-de-modelos-aic-bic" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="criterios-de-selección-de-modelos-aic-bic"><span class="header-section-number">5.5.2</span> Criterios de selección de modelos (AIC, BIC)</h3>
<p>Los criterios de selección de modelos como el <strong>AIC</strong> y el <strong>BIC</strong> permiten comparar modelos que han sido ajustados a los mismos datos, penalizando la complejidad para evitar el sobreajuste.</p>
<p><strong>Akaike Information Criterion (AIC)</strong></p>
<p>El <strong>Criterio de Información de Akaike (AIC)</strong> es una medida que equilibra la calidad del ajuste y la complejidad del modelo. Se calcula como:</p>
<p><span class="math display">\[
AIC = -2 \log(L) + 2k
\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(L\)</span> es el <strong>log-likelihood</strong> del modelo (medida de la probabilidad de los datos dados los parámetros del modelo).</li>
<li><span class="math inline">\(k\)</span> es el número de parámetros del modelo.</li>
</ul>
<p>Respecto a su interpretación, el AIC <strong>no tiene una interpretación absoluta</strong>, solo es útil para comparar modelos ajustados a los mismos datos. Un <strong>AIC menor</strong> indica un mejor equilibrio entre ajuste y simplicidad.</p>
<p><strong>Bayesian Information Criterion (BIC)</strong></p>
<p>El <strong>Criterio de Información Bayesiano (BIC)</strong> es similar al AIC, pero penaliza más severamente la complejidad del modelo, especialmente cuando el número de observaciones es grande. Se calcula como:</p>
<p><span class="math display">\[
BIC = -2 \log(L) + k \log(n)
\]</span></p>
<p>Donde: - <span class="math inline">\(n\)</span> es el número de observaciones.</p>
<p>El BIC favorece modelos más simples en comparación con el AIC. Un <strong>BIC menor</strong> indica un mejor modelo.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: comparación de AIC y BIC">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: comparación de AIC y BIC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación de modelos: Poisson vs Binomial Negativa</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo de Poisson</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>modelo_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(accidentes <span class="sc">~</span> trafico <span class="sc">+</span> visibilidad, <span class="at">family =</span> poisson, <span class="at">data =</span> datos_accidentes)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Binomial Negativa</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>modelo_binom_neg <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(accidentes <span class="sc">~</span> trafico <span class="sc">+</span> visibilidad, <span class="at">data =</span> datos_accidentes)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : iteration limit reached</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in glm.nb(accidentes ~ trafico + visibilidad, data = datos_accidentes):
alternation limit reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular AIC y BIC</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_poisson, modelo_binom_neg)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 df      AIC
modelo_poisson    3 1216.421
modelo_binom_neg  4 1218.497</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(modelo_poisson, modelo_binom_neg)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 df      BIC
modelo_poisson    3 1224.236
modelo_binom_neg  4 1228.918</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>El modelo con el menor <strong>AIC</strong> o <strong>BIC</strong> es preferido. Si ambos modelos tienen valores similares, se puede preferir el modelo más simple (con menos parámetros).</p>
</section>
<section id="validación-cruzada-y-técnicas-de-evaluación-predictiva" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="validación-cruzada-y-técnicas-de-evaluación-predictiva"><span class="header-section-number">5.5.3</span> Validación cruzada y técnicas de evaluación predictiva</h3>
<p>La <strong>validación cruzada</strong> y otras técnicas de evaluación predictiva permiten estimar cómo se desempeñará un modelo en datos no vistos, lo que es esencial para evitar el sobreajuste.</p>
<p>La <strong>validación cruzada k-fold</strong> divide el conjunto de datos en <strong>k</strong> subconjuntos (o “folds”). El modelo se ajusta <strong>k</strong> veces, cada vez utilizando <span class="math inline">\(k-1\)</span> folds para el entrenamiento y el fold restante para la prueba. El rendimiento se promedia sobre todas las iteraciones. La validación cruzada utiliza eficientemente los datos disponibles, proporcionando una estimación robusta del rendimiento del modelo.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Validación cruzada">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Validación cruzada
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar y cargar la librería caret</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir la validación cruzada de 5-fold</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar un modelo de regresión logística con validación cruzada</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>modelo_cv <span class="ot">&lt;-</span> <span class="fu">train</span>(type <span class="sc">~</span> npreg <span class="sc">+</span> glu <span class="sc">+</span> bmi, <span class="at">data =</span> Pima.tr, <span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">trControl =</span> control)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados de la validación cruzada</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(modelo_cv)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

200 samples
  3 predictor
  2 classes: 'No', 'Yes' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 161, 160, 161, 159, 159 
Resampling results:

  Accuracy   Kappa    
  0.7603815  0.4378568</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Otra técnica común es dividir el conjunto de datos en un <strong>conjunto de entrenamiento</strong> (por ejemplo, el <span class="math inline">\(70\%\)</span>) y un <strong>conjunto de prueba</strong> (<span class="math inline">\(30\%\)</span>). El modelo se ajusta en el conjunto de entrenamiento y se evalúa en el conjunto de prueba.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Train/Test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Train/Test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividir el conjunto de datos en entrenamiento y prueba</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(Pima.tr<span class="sc">$</span>type, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>entrenamiento <span class="ot">&lt;-</span> Pima.tr[indices, ]</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>prueba <span class="ot">&lt;-</span> Pima.tr[<span class="sc">-</span>indices, ]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo en el conjunto de entrenamiento</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>modelo_entrenamiento <span class="ot">&lt;-</span> <span class="fu">glm</span>(type <span class="sc">~</span> npreg <span class="sc">+</span> glu <span class="sc">+</span> bmi, <span class="at">data =</span> entrenamiento, <span class="at">family =</span> binomial)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar predicciones en el conjunto de prueba</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_entrenamiento, <span class="at">newdata =</span> prueba, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluar precisión</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>predicciones_clase <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicciones <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(predicciones_clase), <span class="fu">as.factor</span>(prueba<span class="sc">$</span>type))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction No Yes
       No  34  10
       Yes  5  10
                                          
               Accuracy : 0.7458          
                 95% CI : (0.6156, 0.8502)
    No Information Rate : 0.661           
    P-Value [Acc &gt; NIR] : 0.1062          
                                          
                  Kappa : 0.3959          
                                          
 Mcnemar's Test P-Value : 0.3017          
                                          
            Sensitivity : 0.8718          
            Specificity : 0.5000          
         Pos Pred Value : 0.7727          
         Neg Pred Value : 0.6667          
             Prevalence : 0.6610          
         Detection Rate : 0.5763          
   Detection Prevalence : 0.7458          
      Balanced Accuracy : 0.6859          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="diagnóstico-de-residuos-y-buenas-prácticas" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="diagnóstico-de-residuos-y-buenas-prácticas"><span class="header-section-number">5.5.4</span> Diagnóstico de residuos y buenas prácticas</h3>
<p>El análisis de <strong>residuos</strong> es fundamental para evaluar el ajuste del modelo y detectar problemas como la falta de ajuste, valores atípicos o violaciones de los supuestos del modelo.</p>
<p>Los <strong>residuos deviance</strong> son una medida común en los <strong>Modelos Lineales Generalizados (GLM)</strong>. Representan la diferencia entre el modelo ajustado y el modelo perfecto (donde la predicción es exactamente igual al valor observado).</p>
<p><strong>Tipos de residuos:</strong></p>
<ul>
<li><p><strong>Residuos Pearson:</strong><br>
<span class="math display">\[
r_i = \frac{y_i - \hat{y}_i}{\sqrt{\hat{V}(y_i)}}
\]</span> Donde <span class="math inline">\(\hat{V}(y_i)\)</span> es la varianza estimada de <span class="math inline">\(y_i\)</span>.</p></li>
<li><p><strong>Residuos Deviance:</strong><br>
Representan la contribución de cada observación al deviance total del modelo.</p></li>
</ul>
<hr>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Análisis de los residuos">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Análisis de los residuos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de residuos deviance para un modelo de Poisson</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(modelo_poisson, <span class="at">type =</span> <span class="st">"deviance"</span>), </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuos Deviance del Modelo Poisson"</span>, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuos Deviance"</span>, <span class="at">xlab =</span> <span class="st">"Índice"</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema4_files/figure-html/res1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de residuos para la regresión logística</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(modelo_entrenamiento, <span class="at">type =</span> <span class="st">"deviance"</span>), </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuos Deviance del Modelo Logístico"</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuos Deviance"</span>, <span class="at">xlab =</span> <span class="st">"Índice"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema4_files/figure-html/res1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Para detectar valores atípicos y su influencia emplearemos:</p>
<ul>
<li><strong>Distancia de Cook:</strong> Identifica observaciones influyentes que tienen un impacto significativo en los coeficientes del modelo.</li>
<li><strong>Leverage:</strong> Mide el impacto potencial de una observación en el ajuste del modelo.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Detección de observaciones influyentes">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Detección de observaciones influyentes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia de Cook para identificar observaciones influyentes</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo_poisson)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de la distancia de Cook</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cooksd, <span class="at">main =</span> <span class="st">"Distancia de Cook"</span>, <span class="at">ylab =</span> <span class="st">"Influencia"</span>, <span class="at">xlab =</span> <span class="st">"Índice"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">length</span>(cooksd), <span class="at">col =</span> <span class="st">"red"</span>)  <span class="co"># Línea de referencia</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tema4_files/figure-html/influyentes-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-coxe2009analysis" class="csl-entry" role="listitem">
Coxe, Stefany, Stephen G West, y Leona S Aiken. 2009. <span>«The analysis of count data: A gentle introduction to Poisson regression and its alternatives»</span>. <em>Journal of personality assessment</em> 91 (2): 121-36.
</div>
<div id="ref-hosmer2013applied" class="csl-entry" role="listitem">
Hosmer Jr, David W, Stanley Lemeshow, y Rodney X Sturdivant. 2013. <em>Applied logistic regression</em>. John Wiley &amp; Sons.
</div>
<div id="ref-lambert1992zero" class="csl-entry" role="listitem">
Lambert, Diane. 1992. <span>«Zero-inflated Poisson regression, with an application to defects in manufacturing»</span>. <em>Technometrics</em> 34 (1): 1-14.
</div>
<div id="ref-nelder1972generalized" class="csl-entry" role="listitem">
Nelder, John Ashworth, y Robert WM Wedderburn. 1972. <span>«Generalized linear models»</span>. <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em> 135 (3): 370-84.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tema3.html" class="pagination-link" aria-label="Modelos no lineales. Transformación de variables. Ingeniería de características.">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelos no lineales. Transformación de variables. Ingeniería de características.</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tema5.html" class="pagination-link" aria-label="Otros modelos de regresión: Modelos Aditivos Generalizados (GAMs)">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Otros modelos de regresión: Modelos Aditivos Generalizados (GAMs)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>