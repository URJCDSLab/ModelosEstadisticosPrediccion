<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; El modelo de regresión lineal simple – Modelos Estadísticos para la Predicción</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tema2.html" rel="next">
<link href="./tema0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1b90310288666db1f83ae9fc236520cd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tema1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal simple</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelos Estadísticos para la Predicción</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción a los modelos de regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal simple</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Métodos de selección de variables y problemas de regularización</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelos no lineales. Transformación de variables. Ingeniería de características.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos de regresión generalizada</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Otros modelos de regresión: Modelos Aditivos Generalizados (GAMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Conclusiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#exploración-inicial-visualización-y-cuantificación-de-la-relación" id="toc-exploración-inicial-visualización-y-cuantificación-de-la-relación" class="nav-link active" data-scroll-target="#exploración-inicial-visualización-y-cuantificación-de-la-relación"><span class="header-section-number">2.1</span> Exploración inicial: visualización y cuantificación de la relación</a>
  <ul class="collapse">
  <li><a href="#visualización-el-gráfico-de-dispersión" id="toc-visualización-el-gráfico-de-dispersión" class="nav-link" data-scroll-target="#visualización-el-gráfico-de-dispersión"><span class="header-section-number">2.1.1</span> Visualización: el gráfico de dispersión</a></li>
  <li><a href="#cuantificación-de-la-asociación-covarianza-y-correlación" id="toc-cuantificación-de-la-asociación-covarianza-y-correlación" class="nav-link" data-scroll-target="#cuantificación-de-la-asociación-covarianza-y-correlación"><span class="header-section-number">2.1.2</span> Cuantificación de la asociación: covarianza y correlación</a></li>
  </ul></li>
  <li><a href="#formulación-teórica-del-modelo" id="toc-formulación-teórica-del-modelo" class="nav-link" data-scroll-target="#formulación-teórica-del-modelo"><span class="header-section-number">2.2</span> Formulación teórica del modelo</a>
  <ul class="collapse">
  <li><a href="#el-modelo-poblacional-y-sus-componentes" id="toc-el-modelo-poblacional-y-sus-componentes" class="nav-link" data-scroll-target="#el-modelo-poblacional-y-sus-componentes"><span class="header-section-number">2.2.1</span> El modelo poblacional y sus componentes</a></li>
  <li><a href="#los-supuestos-del-modelo-lineal-clásico-gauss-markov" id="toc-los-supuestos-del-modelo-lineal-clásico-gauss-markov" class="nav-link" data-scroll-target="#los-supuestos-del-modelo-lineal-clásico-gauss-markov"><span class="header-section-number">2.2.2</span> Los supuestos del modelo lineal clásico (Gauss-Markov)</a></li>
  </ul></li>
  <li><a href="#estimación-de-los-parámetros" id="toc-estimación-de-los-parámetros" class="nav-link" data-scroll-target="#estimación-de-los-parámetros"><span class="header-section-number">2.3</span> Estimación de los parámetros</a>
  <ul class="collapse">
  <li><a href="#el-criterio-de-mínimos-cuadrados" id="toc-el-criterio-de-mínimos-cuadrados" class="nav-link" data-scroll-target="#el-criterio-de-mínimos-cuadrados"><span class="header-section-number">2.3.1</span> El criterio de mínimos cuadrados</a></li>
  <li><a href="#derivación-matemática-de-los-estimadores" id="toc-derivación-matemática-de-los-estimadores" class="nav-link" data-scroll-target="#derivación-matemática-de-los-estimadores"><span class="header-section-number">2.3.2</span> Derivación matemática de los estimadores</a></li>
  </ul></li>
  <li><a href="#inferencia-y-bondad-de-ajuste" id="toc-inferencia-y-bondad-de-ajuste" class="nav-link" data-scroll-target="#inferencia-y-bondad-de-ajuste"><span class="header-section-number">2.4</span> Inferencia y bondad de ajuste</a>
  <ul class="collapse">
  <li><a href="#propiedades-de-los-estimadores-de-mco" id="toc-propiedades-de-los-estimadores-de-mco" class="nav-link" data-scroll-target="#propiedades-de-los-estimadores-de-mco"><span class="header-section-number">2.4.1</span> Propiedades de los estimadores de MCO</a></li>
  <li><a href="#estimación-de-la-varianza-del-error" id="toc-estimación-de-la-varianza-del-error" class="nav-link" data-scroll-target="#estimación-de-la-varianza-del-error"><span class="header-section-number">2.4.2</span> Estimación de la varianza del error</a></li>
  <li><a href="#análisis-de-la-varianza-anova-para-la-significancia-de-la-regresión" id="toc-análisis-de-la-varianza-anova-para-la-significancia-de-la-regresión" class="nav-link" data-scroll-target="#análisis-de-la-varianza-anova-para-la-significancia-de-la-regresión"><span class="header-section-number">2.4.3</span> Análisis de la Varianza (ANOVA) para la significancia de la regresión</a></li>
  <li><a href="#bondad-del-ajuste-coeficiente-de-determinación" id="toc-bondad-del-ajuste-coeficiente-de-determinación" class="nav-link" data-scroll-target="#bondad-del-ajuste-coeficiente-de-determinación"><span class="header-section-number">2.4.4</span> Bondad del ajuste: coeficiente de determinación</a></li>
  <li><a href="#inferencia-sobre-los-coeficientes" id="toc-inferencia-sobre-los-coeficientes" class="nav-link" data-scroll-target="#inferencia-sobre-los-coeficientes"><span class="header-section-number">2.4.5</span> Inferencia sobre los coeficientes</a></li>
  </ul></li>
  <li><a href="#predicción-de-nuevas-observaciones" id="toc-predicción-de-nuevas-observaciones" class="nav-link" data-scroll-target="#predicción-de-nuevas-observaciones"><span class="header-section-number">2.5</span> Predicción de nuevas observaciones</a>
  <ul class="collapse">
  <li><a href="#intervalo-de-confianza-para-la-respuesta-media" id="toc-intervalo-de-confianza-para-la-respuesta-media" class="nav-link" data-scroll-target="#intervalo-de-confianza-para-la-respuesta-media"><span class="header-section-number">2.5.1</span> Intervalo de confianza para la respuesta media</a></li>
  <li><a href="#intervalo-de-predicción-para-una-respuesta-individual" id="toc-intervalo-de-predicción-para-una-respuesta-individual" class="nav-link" data-scroll-target="#intervalo-de-predicción-para-una-respuesta-individual"><span class="header-section-number">2.5.2</span> Intervalo de predicción para una respuesta individual</a></li>
  </ul></li>
  <li><a href="#diagnóstico-del-modelo" id="toc-diagnóstico-del-modelo" class="nav-link" data-scroll-target="#diagnóstico-del-modelo"><span class="header-section-number">2.6</span> Diagnóstico del Modelo</a>
  <ul class="collapse">
  <li><a href="#linealidad" id="toc-linealidad" class="nav-link" data-scroll-target="#linealidad"><span class="header-section-number">2.6.1</span> Linealidad</a></li>
  <li><a href="#homocedasticidad" id="toc-homocedasticidad" class="nav-link" data-scroll-target="#homocedasticidad"><span class="header-section-number">2.6.2</span> Homocedasticidad</a></li>
  <li><a href="#normalidad-de-los-residuos" id="toc-normalidad-de-los-residuos" class="nav-link" data-scroll-target="#normalidad-de-los-residuos"><span class="header-section-number">2.6.3</span> Normalidad de los residuos</a></li>
  <li><a href="#independencia-de-los-residuos" id="toc-independencia-de-los-residuos" class="nav-link" data-scroll-target="#independencia-de-los-residuos"><span class="header-section-number">2.6.4</span> Independencia de los residuos</a></li>
  <li><a href="#media-nula-de-los-residuos" id="toc-media-nula-de-los-residuos" class="nav-link" data-scroll-target="#media-nula-de-los-residuos"><span class="header-section-number">2.6.5</span> Media nula de los residuos</a></li>
  <li><a href="#identificación-de-observaciones-influyentes-y-atípicas" id="toc-identificación-de-observaciones-influyentes-y-atípicas" class="nav-link" data-scroll-target="#identificación-de-observaciones-influyentes-y-atípicas"><span class="header-section-number">2.6.6</span> Identificación de observaciones influyentes y atípicas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-regresion-lineal-simple" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal simple</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>La regresión lineal constituye uno de los pilares fundamentales de la modelización estadística. Es, a menudo, el primer y más importante modelo predictivo que se aprende, no solo por su simplicidad e interpretabilidad, sino porque los conceptos que exploraremos aquí son la base sobre la que se construyen técnicas mucho más avanzadas, como el <strong>modelo de regresión lineal múltiple</strong>, los <strong>modelos lineales generalizados (GLM)</strong> o incluso conceptos utilizados en algoritmos de <em>machine learning</em> <span class="citation" data-cites="draper1998applied kutner2005applied james2021">(<a href="references.html#ref-draper1998applied" role="doc-biblioref">Draper 1998</a>; <a href="references.html#ref-kutner2005applied" role="doc-biblioref">Kutner et&nbsp;al. 2005</a>; <a href="references.html#ref-james2021" role="doc-biblioref">James et&nbsp;al. 2021</a>)</span>.</p>
<p>En este capítulo, daremos el primer y más crucial paso en nuestro viaje por el modelado predictivo: el estudio del <strong>modelo de regresión lineal simple</strong>. Para ello, seguiremos el ciclo de vida completo de un proyecto de modelado: comenzaremos con la exploración visual y cuantitativa de los datos, formalizaremos después nuestras observaciones mediante el lenguaje matemático del modelo y sus supuestos, aprenderemos a estimar sus parámetros, realizaremos inferencias sobre ellos y, finalmente, diagnosticaremos la validez de nuestro modelo <span class="citation" data-cites="fox2018r harrell2015">(<a href="references.html#ref-fox2018r" role="doc-biblioref">Fox y Weisberg 2018</a>; <a href="references.html#ref-harrell2015" role="doc-biblioref">Harrell 2015</a>)</span>.</p>
<p>La comprensión profunda que desarrollaremos aquí es esencial, ya que los principios de estimación, inferencia y diagnóstico que aprenderemos son directamente escalables al <strong>modelo de regresión lineal múltiple</strong>, que exploraremos en el siguiente capítulo.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Objetivos de aprendizaje">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Objetivos de aprendizaje
</div>
</div>
<div class="callout-body-container callout-body">
<p>Al finalizar este capítulo, serás capaz de:</p>
<ol type="1">
<li><strong>Comprender y aplicar</strong> el proceso de modelización estadística para un problema con una única variable predictora.</li>
<li><strong>Identificar y medir la correlación lineal</strong> entre dos variables como paso previo al modelado.</li>
<li><strong>Describir la formulación matemática</strong> del modelo de regresión lineal simple e interpretar el significado práctico de sus parámetros.</li>
<li><strong>Estimar los coeficientes</strong> del modelo mediante el método de mínimos cuadrados ordinarios (MCO) y entender su derivación matemática y propiedades.</li>
<li><strong>Realizar inferencias sobre los parámetros</strong> del modelo y evaluar su bondad de ajuste mediante el análisis de la varianza y el coeficiente de determinación R².</li>
<li><strong>Diagnosticar la adecuación del modelo</strong>, evaluando visual y analíticamente si se cumplen los supuestos del modelo lineal.</li>
</ol>
</div>
</div>
<section id="exploración-inicial-visualización-y-cuantificación-de-la-relación" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="exploración-inicial-visualización-y-cuantificación-de-la-relación"><span class="header-section-number">2.1</span> Exploración inicial: visualización y cuantificación de la relación</h2>
<p>Antes de sumergirnos en la teoría de la regresión, debemos hacer lo que todo buen analista hace primero: <strong>observar y cuantificar la relación en los datos</strong>. Este paso exploratorio es fundamental para formular hipótesis y justificar la elección de un modelo lineal.</p>
<section id="visualización-el-gráfico-de-dispersión" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="visualización-el-gráfico-de-dispersión"><span class="header-section-number">2.1.1</span> Visualización: el gráfico de dispersión</h3>
<p>La herramienta más potente para examinar la relación entre dos variables continuas es el <strong>gráfico de dispersión</strong> (<em>scatterplot</em>). Nos permite intuir visualmente la <strong>forma</strong>, la <strong>dirección</strong> y la <strong>fuerza</strong> de la relación. Una inspección visual es siempre el punto de partida.</p>
</section>
<section id="cuantificación-de-la-asociación-covarianza-y-correlación" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="cuantificación-de-la-asociación-covarianza-y-correlación"><span class="header-section-number">2.1.2</span> Cuantificación de la asociación: covarianza y correlación</h3>
<p>Una vez que la visualización sugiere una tendencia, necesitamos métricas para cuantificarla.</p>
<section id="covarianza" class="level4" data-number="2.1.2.1">
<h4 data-number="2.1.2.1" class="anchored" data-anchor-id="covarianza"><span class="header-section-number">2.1.2.1</span> Covarianza</h4>
<p>La <strong>covarianza</strong> es una medida de la variabilidad conjunta de dos variables aleatorias, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. Nos indica la dirección de la relación lineal. La covarianza muestral, calculada a partir de nuestras observaciones <span class="math inline">\((x_i, y_i)\)</span>, es:</p>
<p><span class="math display">\[
\text{Cov}(x, y) = s_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{n-1}
\]</span></p>
<p>El principal inconveniente de la covarianza es que su magnitud depende de las unidades de las variables, lo que la hace difícil de interpretar.</p>
</section>
<section id="coeficiente-de-correlación-de-pearson" class="level4" data-number="2.1.2.2">
<h4 data-number="2.1.2.2" class="anchored" data-anchor-id="coeficiente-de-correlación-de-pearson"><span class="header-section-number">2.1.2.2</span> Coeficiente de correlación de Pearson</h4>
<p>Para solucionar el problema de la escala, estandarizamos la covarianza, dividiéndola por el producto de las desviaciones típicas de cada variable. El resultado es el <strong>coeficiente de correlación de Pearson (</strong><span class="math inline">\(r\)</span>):</p>
<p><span class="math display">\[
r = r_{xy} = \frac{s_{xy}}{s_x s_y}
\]</span></p>
<p>Este coeficiente es <strong>adimensional</strong> y siempre varía entre <strong>-1 y 1</strong>, lo que permite una interpretación universal de la fuerza de la asociación <em>lineal</em>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo práctico: Horas de estudio vs. Calificaciones">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo práctico: Horas de estudio vs.&nbsp;Calificaciones
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a plantear un problema que nos acompañará durante todo el capítulo: queremos saber si el tiempo de estudio semanal influye en las calificaciones finales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Para reproducibilidad</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de datos</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tiempo_Estudio =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">40</span>), <span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Calificaciones <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> datos<span class="sc">$</span>Tiempo_Estudio <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>), <span class="dv">2</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo_Estudio, <span class="at">y =</span> Calificaciones)) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relación entre Tiempo de Estudio y Calificaciones"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tiempo de Estudio (horas/semana)"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Calificaciones (promedio)"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuantificación (los objetos se guardan para usarlos en el texto)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>covarianza <span class="ot">&lt;-</span> <span class="fu">cov</span>(datos<span class="sc">$</span>Tiempo_Estudio, datos<span class="sc">$</span>Calificaciones)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>correlacion <span class="ot">&lt;-</span> <span class="fu">cor</span>(datos<span class="sc">$</span>Tiempo_Estudio, datos<span class="sc">$</span>Calificaciones)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exploracion-inicial-full" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exploracion-inicial-full-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-exploracion-inicial-full-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exploracion-inicial-full-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.1: Relación entre tiempo de estudio y calificaciones.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra una clara tendencia lineal positiva. La covarianza toma un valor de 9.82, y el coeficiente de correlación de Pearson es de 0.9. Ambos valores confirman que la asociación lineal es, además de positiva, muy fuerte. Esta evidencia visual y numérica nos da una base sólida para proponer un modelo de regresión lineal.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="¡Correlación no implica causalidad!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
¡Correlación no implica causalidad!
</div>
</div>
<div class="callout-body-container callout-body">
<p>El haber encontrado una fuerte correlación positiva entre el tiempo de estudio y las calificaciones (0.9) no nos autoriza a concluir que <em>una cosa causa la otra</em>. La regresión lineal puede demostrar que las variables se mueven juntas y nos permite predecir una a partir de la otra, pero no explica el porqué de la relación.</p>
<p>Podría existir una tercera variable oculta (p.&nbsp;ej., el interés del alumno en la materia) que influya tanto en las horas de estudio como en las calificaciones. Establecer causalidad requiere un diseño experimental riguroso (asignando aleatoriamente a los estudiantes a diferentes tiempos de estudio), no solo un análisis observacional.</p>
</div>
</div>
</section>
</section>
</section>
<section id="formulación-teórica-del-modelo" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="formulación-teórica-del-modelo"><span class="header-section-number">2.2</span> Formulación teórica del modelo</h2>
<p>Una vez que la exploración sugiere una relación lineal, el siguiente paso es formalizarla matemáticamente. Aquí es donde definimos la estructura teórica del modelo y los supuestos bajo los cuales operará.</p>
<section id="el-modelo-poblacional-y-sus-componentes" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="el-modelo-poblacional-y-sus-componentes"><span class="header-section-number">2.2.1</span> El modelo poblacional y sus componentes</h3>
<p>El <strong>modelo poblacional</strong> postula que la relación verdadera entre la variable respuesta <span class="math inline">\(Y\)</span> y la predictora <span class="math inline">\(X\)</span> sigue una línea recta, aunque contaminada por cierta aleatoriedad. Para cualquier individuo <span class="math inline">\(i\)</span> de la población, esta relación se describe como:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i
\]</span></p>
<p>En esta ecuación, <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> son los <strong>parámetros poblacionales</strong> (el intercepto y la pendiente verdaderos pero desconocidos), y <span class="math inline">\(\varepsilon_i\)</span> es el <strong>error aleatorio</strong>, un componente fundamental que captura todas las fuentes de variabilidad que el modelo no puede explicar por sí solo. Específicamente, este término incluye:</p>
<ul>
<li><strong>Variables omitidas:</strong> Factores que también afectan a las calificaciones (como la calidad del sueño, la motivación del estudiante o su conocimiento previo) y que no están en el modelo.</li>
<li><strong>Error de medida:</strong> Pequeñas imprecisiones al medir las variables (p.&nbsp;ej., un estudiante podría reportar 20 horas de estudio cuando en realidad fueron 19.5).</li>
<li><strong>Aleatoriedad inherente:</strong> La variabilidad puramente estocástica o impredecible en el comportamiento humano.</li>
</ul>
<p>Como nunca observamos la población entera, nuestro trabajo consiste en usar una muestra para estimar el <strong>modelo muestral</strong>:</p>
<p><span class="math display">\[
\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i
\]</span></p>
<p>Aquí, los “gorros” (<span class="math inline">\(\hat{\cdot}\)</span>) denotan <strong>estimaciones</strong> calculadas a partir de la muestra. La diferencia entre el valor real y el predicho, <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>, se conoce como <strong>residuo</strong>.</p>
</section>
<section id="los-supuestos-del-modelo-lineal-clásico-gauss-markov" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="los-supuestos-del-modelo-lineal-clásico-gauss-markov"><span class="header-section-number">2.2.2</span> Los supuestos del modelo lineal clásico (Gauss-Markov)</h3>
<p>Para que el puente entre nuestro modelo muestral y la realidad poblacional sea sólido, debemos asumir que los errores teóricos <span class="math inline">\(\varepsilon_i\)</span> se comportan de una manera predecible y ordenada. Estos supuestos, conocidos como condiciones de Gauss-Markov <span class="citation" data-cites="kutner2005applied weisberg2005applied">(<a href="references.html#ref-kutner2005applied" role="doc-biblioref">Kutner et&nbsp;al. 2005</a>; <a href="references.html#ref-weisberg2005applied" role="doc-biblioref">Weisberg 2005</a>)</span>, son fundamentales para las propiedades óptimas de los estimadores de mínimos cuadrados.</p>
<ol type="1">
<li><strong>Linealidad</strong>: La relación entre <span class="math inline">\(X\)</span> y el valor esperado de <span class="math inline">\(Y\)</span> es, en promedio, una línea recta: <span class="math inline">\(E[Y_i | X_i] = \beta_0 + \beta_1 X_i\)</span>.</li>
<li><strong>Independencia de los errores</strong>: El error de una observación no está correlacionado con el error de ninguna otra: <span class="math inline">\(\text{Cov}(\varepsilon_i, \varepsilon_j) = 0\)</span> para <span class="math inline">\(i \neq j\)</span>.</li>
<li><strong>Homocedasticidad</strong>: La varianza del error es constante (<span class="math inline">\(\sigma^2\)</span>) para todos los valores de <span class="math inline">\(X\)</span>: <span class="math inline">\(Var(\varepsilon_i | X_i) = \sigma^2\)</span>. Esto significa que la dispersión de los datos alrededor de la línea de regresión es la misma a lo largo de todos los valores de la variable predictora. La violación de este supuesto se conoce como <strong>heterocedasticidad</strong>, donde la dispersión de los errores cambia (p.&nbsp;ej., aumenta a medida que <span class="math inline">\(X\)</span> crece).</li>
</ol>
<p>Cuando el objetivo no es sólo estimar la recta, sino inferir con ella, entonces se asume una hipótesis más: la normalidad de la variable respuesta, o lo que es lo mismo, del error aleatorio:</p>
<ol start="4" type="1">
<li><strong>Normalidad de los errores</strong>: Para la inferencia, se asume que los errores siguen una distribución Normal con media cero y varianza <span class="math inline">\(\sigma^2\)</span>: <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span>.</li>
</ol>
<p>Estos supuestos son esenciales para garantizar la validez de las estimaciones y conclusiones derivadas del modelo.</p>
</section>
</section>
<section id="estimación-de-los-parámetros" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="estimación-de-los-parámetros"><span class="header-section-number">2.3</span> Estimación de los parámetros</h2>
<p>Necesitamos un método para encontrar la “mejor” recta de ajuste. El <strong>Método de Mínimos Cuadrados Ordinarios (MCO/OLS)</strong> nos proporciona este criterio.</p>
<section id="el-criterio-de-mínimos-cuadrados" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="el-criterio-de-mínimos-cuadrados"><span class="header-section-number">2.3.1</span> El criterio de mínimos cuadrados</h3>
<p>MCO busca la recta que minimice la <strong>Suma de los Cuadrados del Error (SSE)</strong>, es decir, la suma de las distancias verticales al cuadrado entre los puntos observados y la recta de regresión:</p>
<p><span class="math display">\[
\text{SSE}(\beta_0, \beta_1) = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n} (y_i-\hat{y})^2 = \sum_{i=1}^{n} (y_i - (\beta_0 + \beta_1 x_i))^2
\]</span></p>
</section>
<section id="derivación-matemática-de-los-estimadores" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="derivación-matemática-de-los-estimadores"><span class="header-section-number">2.3.2</span> Derivación matemática de los estimadores</h3>
<p>Para encontrar los valores de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> que minimizan esta función, recurrimos al cálculo. Tratamos la SSE como una función de dos variables y calculamos sus derivadas parciales, igualándolas a cero para encontrar el mínimo.</p>
<p><span class="math display">\[
\frac{\partial \text{SSE}}{\partial \beta_0} = -2 \sum_{i=1}^{n} (y_i - \beta_0 - \beta_1 x_i) = 0
\]</span></p>
<p><span class="math display">\[
\frac{\partial \text{SSE}}{\partial \beta_1} = -2 \sum_{i=1}^{n} x_i (y_i - \beta_0 - \beta_1 x_i) = 0
\]</span></p>
<p>La resolución de este sistema de dos ecuaciones (conocidas como las <strong>ecuaciones normales</strong>) nos proporciona las fórmulas para los estimadores de MCO:</p>
<p><span class="math display">\[
\hat{\beta}_1 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n}(x_i - \bar{x})^2} = \frac{s_{xy}}{s_{xx}}
\]</span> <span class="math display">\[ \hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}
\]</span></p>
<section id="interpretación-práctica-de-los-coeficientes" class="level4" data-number="2.3.2.1">
<h4 data-number="2.3.2.1" class="anchored" data-anchor-id="interpretación-práctica-de-los-coeficientes"><span class="header-section-number">2.3.2.1</span> Interpretación práctica de los coeficientes</h4>
<p>Una vez estimados, los coeficientes tienen una interpretación muy concreta y útil:</p>
<ul>
<li><p><strong>Pendiente (</strong><span class="math inline">\(\hat{\beta}_1\)</span>): Representa el cambio promedio estimado en la variable respuesta <span class="math inline">\(Y\)</span> por cada <strong>aumento de una unidad</strong> en la variable predictora <span class="math inline">\(X\)</span>. En nuestro ejemplo, sería el número de puntos que se espera que aumente la calificación final por cada hora adicional de estudio semanal.</p></li>
<li><p><strong>Intercepto (</strong><span class="math inline">\(\hat{\beta}_0\)</span>): Es el valor promedio estimado de la variable respuesta <span class="math inline">\(Y\)</span> cuando la variable predictora <span class="math inline">\(X\)</span> es igual a cero. La interpretación del intercepto solo tiene sentido práctico si <span class="math inline">\(X=0\)</span> es un valor plausible y se encuentra dentro del rango de nuestros datos. De lo contrario (como en nuestro ejemplo, donde nadie estudia 0 horas), a menudo se considera simplemente un ancla matemática para la recta de regresión.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Minimización de SSE">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Minimización de SSE
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La obtención de los estimadores de mínimos cuadrados para la regresión lineal simple se basa en minimizar la suma de los cuadrados de los residuos (<span class="math inline">\(SSE\)</span>). Este método, desarrollado por Legendre y Gauss a principios del siglo XIX <span class="citation" data-cites="galton1886 weisberg2005applied">(<a href="references.html#ref-galton1886" role="doc-biblioref">Galton 1886</a>; <a href="references.html#ref-weisberg2005applied" role="doc-biblioref">Weisberg 2005</a>)</span>, es fundamental en la estadística moderna. Aquí está el proceso paso a paso:</p>
<p>Para minimizar <span class="math inline">\(SSE\)</span>, derivamos parcialmente con respecto a <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> y resolvemos el sistema de ecuaciones.</p>
<ol type="1">
<li><strong>Primera derivada con respecto a</strong> <span class="math inline">\(\beta_0\)</span>:</li>
</ol>
<p><span class="math display">\[
    \frac{\partial SSE}{\partial \beta_0} = -2\sum_{i=1}^n
    \left(y_i - (\beta_0 + \beta_1 x_i)\right).
  \]</span></p>
<pre><code>Igualando a cero: </code></pre>
<p><span class="math display">\[
    \sum_{i=1}^n \left(y_i - \beta_0 - \beta_1
    x_i\right) = 0.
  \]</span></p>
<pre><code>Reordenando: </code></pre>
<p><span class="math display">\[
    n\beta_0 + \beta_1 \sum_{i=1}^n x_i = \sum_{i=1}^n y_i. \tag{1}
  \]</span></p>
<ol start="2" type="1">
<li><strong>Primera derivada con respecto a</strong> <span class="math inline">\(\beta_1\)</span>:</li>
</ol>
<p><span class="math display">\[
    \frac{\partial SSE}{\partial \beta_1} = -2\sum_{i=1}^n x_i
    \left(y_i - (\beta_0 + \beta_1 x_i)\right).
    \]</span></p>
<pre><code>Igualando a cero: </code></pre>
<p><span class="math display">\[
    \sum_{i=1}^n x_i \left(y_i - \beta_0 -
    \beta_1 x_i\right) = 0.
   \]</span></p>
<pre><code>Reordenando: </code></pre>
<p><span class="math display">\[
    \beta_0 \sum_{i=1}^n x_i + \beta_1 \sum_{i=1}^n x_i^2 = \sum_{i=1}^n x_i y_i. \tag{2}
   \]</span></p>
<p><strong>Resolución del Sistema de Ecuaciones</strong></p>
<p>El sistema está dado por las ecuaciones (1) y (2):</p>
<ol type="1">
<li><span class="math inline">\(n\beta_0 + \beta_1 \sum_{i=1}^n x_i = \sum_{i=1}^n y_i.\)</span><br>
</li>
<li><span class="math inline">\(\beta_0 \sum_{i=1}^n x_i + \beta_1 \sum_{i=1}^n x_i^2 = \sum_{i=1}^n x_i y_i.\)</span></li>
</ol>
<p>Resolviendo para <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>:</p>
<ol type="1">
<li><p>De la primera ecuación, despejamos <span class="math inline">\(\beta_0\)</span>:<br>
<span class="math display">\[
\beta_0 = \frac{\sum_{i=1}^n y_i - \beta_1 \sum_{i=1}^n x_i}{n}. \tag{3}
\]</span></p></li>
<li><p>Sustituimos <span class="math inline">\(\beta_0\)</span> en la segunda ecuación:<br>
<span class="math display">\[
\frac{\sum_{i=1}^n y_i - \beta_1 \sum_{i=1}^n x_i}{n} \sum_{i=1}^n x_i + \beta_1 \sum_{i=1}^n x_i^2 = \sum_{i=1}^n x_i y_i.
\]</span></p>
<p>Simplificando:<br>
<span class="math display">\[
\beta_1 \left(\sum_{i=1}^n x_i^2 - \frac{(\sum_{i=1}^n x_i)^2}{n}\right) = \sum_{i=1}^n x_i y_i - \frac{\sum_{i=1}^n x_i \sum_{i=1}^n y_i}{n}.
\]</span></p></li>
<li><p>Expresamos <span class="math inline">\(\beta_1\)</span>:<br>
<span class="math display">\[
\beta_1 = \frac{\sum_{i=1}^n x_i y_i - \frac{\sum_{i=1}^n x_i \sum_{i=1}^n y_i}{n}}{\sum_{i=1}^n x_i^2 - \frac{(\sum_{i=1}^n x_i)^2}{n}}.
\]</span> Esta es la fórmula para <span class="math inline">\(\beta_1\)</span>, que puede reescribirse como:<br>
<span class="math display">\[
\beta_1 = \frac{\text{Cov}(x, y)}{\text{Var}(x)},
\]</span> donde <span class="math inline">\(\text{Cov}(x, y)\)</span> y <span class="math inline">\(\text{Var}(x)\)</span> son la covarianza y la varianza muestral de <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>.</p></li>
<li><p>Finalmente, sustituimos <span class="math inline">\(\beta_1\)</span> en la ecuación (3) para obtener <span class="math inline">\(\beta_0\)</span>:<br>
<span class="math display">\[
\beta_0 = \bar{y} - \beta_1 \bar{x},
\]</span> donde <span class="math inline">\(\bar{x}\)</span> y <span class="math inline">\(\bar{y}\)</span> son las medias de <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>.</p></li>
</ol>
</div>
</div>
</div>
<p>Bajo los supuestos del modelo, el <strong>Teorema de Gauss-Markov</strong> demuestra que estos estimadores son los <strong>Mejores Estimadores Lineales Insesgados (MELI / BLUE)</strong>.</p>
</section>
</section>
</section>
<section id="inferencia-y-bondad-de-ajuste" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="inferencia-y-bondad-de-ajuste"><span class="header-section-number">2.4</span> Inferencia y bondad de ajuste</h2>
<p>Una vez hemos estimado los parámetros del modelo, nuestro trabajo apenas ha comenzado. Ahora debemos pasar de la descripción a la inferencia. Necesitamos un conjunto de herramientas que nos permitan responder a preguntas cruciales: ¿Son nuestros coeficientes estimados, <span class="math inline">\(\hat{\beta}_0\)</span> y <span class="math inline">\(\hat{\beta}_1\)</span>, meras casualidades de nuestra muestra o reflejan una relación real en la población? ¿Qué tan bueno es nuestro modelo para explicar la variabilidad de la variable respuesta? Esta sección se dedica a responder estas preguntas.</p>
<section id="propiedades-de-los-estimadores-de-mco" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="propiedades-de-los-estimadores-de-mco"><span class="header-section-number">2.4.1</span> Propiedades de los estimadores de MCO</h3>
<p>Antes de realizar inferencias, es fundamental entender las propiedades teóricas de los estimadores que hemos calculado.</p>
<ul>
<li><p><strong>Insesgadez</strong>: Los estimadores de MCO son insesgados. Esto significa que si pudiéramos repetir nuestro muestreo muchísimas veces y calcular los estimadores en cada muestra, el promedio de todas nuestras estimaciones de <span class="math inline">\(\hat{\beta}_0\)</span> y <span class="math inline">\(\hat{\beta}_1\)</span> convergería a los verdaderos valores poblacionales <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>. Matemáticamente: <span class="math display">\[
  E[\hat{\beta}_0] = \beta_0 \quad \text{y} \quad E[\hat{\beta}_1] = \beta_1
  \]</span></p></li>
<li><p><strong>Varianza de los estimadores</strong>: Las fórmulas para la varianza de nuestros estimadores cuantifican su precisión. Una varianza pequeña implica que el estimador es más estable a través de diferentes muestras. <span class="math display">\[
  Var(\hat{\beta}_1) = \frac{\sigma^2}{\sum_{i=1}^{n}(x_i - \bar{x})^2} = \frac{\sigma^2}{S_{xx}}
  \]</span> <span class="math display">\[
  Var(\hat{\beta}_0) = \sigma^2 \left[ \frac{1}{n} + \frac{\bar{x}^2}{S_{xx}} \right]
  \]</span> Donde <span class="math inline">\(\sigma^2\)</span> es la varianza (desconocida) del término de error <span class="math inline">\(\varepsilon\)</span>.</p></li>
<li><p><strong>Teorema de Gauss-Markov</strong>: Este es uno de los resultados más importantes de la teoría de la regresión. Establece que, bajo los supuestos de linealidad, independencia y homocedasticidad (no se requiere normalidad), los estimadores de MCO son los <strong>Mejores Estimadores Lineales Insesgados</strong> (MELI, o BLUE en inglés). Esto significa que, de entre toda la clase de estimadores que son lineales e insesgados, los de MCO son los que tienen la menor varianza posible.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Propiedades adicionales para las predicciones y para los residuos">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Propiedades adicionales para las predicciones y para los residuos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>La suma de los residuos es cero: <span class="math display">\[
  \sum_{i=1}^n e_i=\sum_{i=1}^n(y_i-\hat{y_i})=0
  \]</span></p></li>
<li><p>La suma de los valores observados es igual a la suma de los valores ajustados: <span class="math display">\[
  \sum_{i=1}^n y_i=\sum_{i=1}^n \hat{y_i}
  \]</span></p></li>
<li><p>La suma de los residuos ponderados por los regresores es cero: <span class="math display">\[
  \sum_{i=1}^n x_ie_i=0
  \]</span></p></li>
<li><p>La suma de los residuos ponderados por las predicciones es cero: <span class="math display">\[
  \sum_{i=1}^n \hat{y_i}e_i=0
  \]</span></p></li>
<li><p>La recta de regresión contiene el punto <span class="math inline">\((\bar{x},\bar{y})\)</span>:</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Para los datos de calificaciones y tiempo de estudio, estos son los estimadores de los parámetros del modelo de regresión:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Ajustamos el modelo lineal</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>modelo_estudio <span class="ot">&lt;-</span> <span class="fu">lm</span>(Calificaciones <span class="sc">~</span> Tiempo_Estudio, <span class="at">data =</span> datos)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Obtenemos el resumen completo del modelo</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_estudio)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Calificaciones ~ Tiempo_Estudio, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.11465 -0.30262 -0.00942  0.29509  1.10533 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     5.00118    0.11977   41.76   &lt;2e-16 ***
Tiempo_Estudio  0.09875    0.00488   20.23   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4842 on 98 degrees of freedom
Multiple R-squared:  0.8069,    Adjusted R-squared:  0.8049 
F-statistic: 409.5 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimación-de-la-varianza-del-error" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="estimación-de-la-varianza-del-error"><span class="header-section-number">2.4.2</span> Estimación de la varianza del error</h3>
<p>Las fórmulas de la varianza de los estimadores dependen de <span class="math inline">\(\sigma^2\)</span>, la varianza del error poblacional, que es desconocida. Por lo tanto, necesitamos estimarla a partir de nuestros datos. Un estimador insesgado de <span class="math inline">\(\sigma^2\)</span> es la <strong>Media Cuadrática del Error (MSE)</strong>:</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \text{MSE} = \frac{\text{SSE}}{n-2} = \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n-2}
\]</span></p>
<p>Dividimos por <span class="math inline">\(n-2\)</span>, los <strong>grados de libertad del error</strong>, porque hemos “gastado” dos grados de libertad de nuestros datos para estimar los dos parámetros, <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>. La raíz cuadrada de la MSE, <span class="math inline">\(\hat{\sigma}\)</span>, se conoce como el <strong>error estándar de los residuos</strong> y es una medida de la dispersión promedio de los puntos alrededor de la recta de regresión.</p>
<section id="el-error-estándar-de-los-residuos-y-el-rmse" class="level4" data-number="2.4.2.1">
<h4 data-number="2.4.2.1" class="anchored" data-anchor-id="el-error-estándar-de-los-residuos-y-el-rmse"><span class="header-section-number">2.4.2.1</span> El error estándar de los residuos y el RMSE</h4>
<p>La raíz cuadrada de la MSE, <span class="math inline">\(\hat{\sigma}\)</span>, se conoce formalmente como el <strong>error estándar de los residuos</strong> (<em>Residual Standard Error</em>). Este valor es nuestra estimación de la desviación estándar del error poblacional, <span class="math inline">\(\sigma\)</span>, y es una medida de la dispersión promedio de los puntos alrededor de la recta de regresión.</p>
<p><span class="math display">\[
\hat{\sigma} = \sqrt{\text{MSE}}
\]</span></p>
<p>En el campo del modelado predictivo y el <em>machine learning</em>, esta misma cantidad se conoce como la <strong>Raíz del Error Cuadrático Medio</strong> o <strong>RMSE</strong> (<em>Root Mean Squared Error</em>). Aunque la fórmula es idéntica, la interpretación del RMSE se centra en la <strong>evaluación del rendimiento predictivo</strong> del modelo. El RMSE nos dice, en promedio, cuál es la magnitud del error de predicción de nuestro modelo, y tiene la ventaja de estar en las <strong>mismas unidades</strong> que la variable respuesta <span class="math inline">\(Y\)</span>. Por ejemplo, si estamos prediciendo precios de viviendas en euros, un RMSE de 5000 significa que nuestras predicciones se desvían, en promedio, unos 5000 € de los precios reales.</p>
</section>
</section>
<section id="análisis-de-la-varianza-anova-para-la-significancia-de-la-regresión" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="análisis-de-la-varianza-anova-para-la-significancia-de-la-regresión"><span class="header-section-number">2.4.3</span> Análisis de la Varianza (ANOVA) para la significancia de la regresión</h3>
<p>Una vez hemos estimado los coeficientes, necesitamos una prueba formal para determinar si el modelo en su conjunto es útil. Es decir, ¿la variable predictora <span class="math inline">\(X\)</span> explica una porción de la variabilidad de la variable respuesta <span class="math inline">\(Y\)</span> que sea estadísticamente significativa, o la relación que observamos podría deberse simplemente al azar? El <strong>Análisis de la Varianza (ANOVA)</strong> nos proporciona la herramienta para responder a esta pregunta a través del <strong>contraste F de significancia global</strong>.</p>
<p>Las hipótesis de este contraste son:</p>
<ul>
<li><span class="math inline">\(H_0: \beta_1 = 0\)</span>: La hipótesis nula postula que no existe una relación lineal entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. El modelo no tiene poder explicativo y no es mejor que usar simplemente la media, <span class="math inline">\(\bar{y}\)</span>, como predicción para cualquier valor de <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(H_1: \beta_1 \neq 0\)</span>: La hipótesis alternativa sostiene que sí existe una relación lineal significativa.</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled" title="Repaso">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Repaso
</div>
</div>
<div class="callout-body-container callout-body">
<p>Es conveniente repasar el tema de <em>Análisis de la Varianza</em> estudiado en la asignatura de Inferencia, ya que los conceptos son directamente aplicables aquí.</p>
</div>
</div>
<p>La idea fundamental del ANOVA es comparar la variabilidad que nuestro modelo <em>explica</em> con la variabilidad que <em>no puede explicar</em> (el error residual). Para ello, se descompone la variabilidad total de nuestras observaciones (<span class="math inline">\(y_i\)</span>) en dos partes ortogonales.</p>
<ol type="1">
<li><p>La <strong>Suma Total de Cuadrados (SST)</strong> mide la variabilidad total de los datos alrededor de su media. Es nuestra referencia base de la dispersión total que hay que explicar. <span class="math display">\[
\text{SST} = \sum_{i=1}^{n} (y_i - \bar{y})^2
\]</span></p></li>
<li><p>Esta variabilidad se descompone en:</p>
<ul>
<li><strong>Suma de Cuadrados de la Regresión (SSR)</strong>: Mide la parte de la variabilidad total que es explicada por nuestro modelo. Cuantifica cuánto se desvían las predicciones del modelo (<span class="math inline">\(\hat{y}_i\)</span>) de la media general (<span class="math inline">\(\bar{y}\)</span>). <span class="math display">\[
  \text{SSR} = \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2
  \]</span></li>
<li><strong>Suma de Cuadrados del Error (SSE)</strong>: Mide la variabilidad residual, es decir, la parte que el modelo no puede capturar. Cuantifica la dispersión de los puntos reales (<span class="math inline">\(y_i\)</span>) alrededor de la recta de regresión (<span class="math inline">\(\hat{y}_i\)</span>). <span class="math display">\[
  \text{SSE} = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
  \]</span></li>
</ul></li>
</ol>
<p>La descomposición fundamental de la varianza es, por tanto: <span class="math inline">\(\text{SST} = \text{SSR} + \text{SSE}\)</span>.</p>
<p>Para poder comparar estas sumas de cuadrados de forma justa, las estandarizamos dividiéndolas por sus respectivos <strong>grados de libertad</strong>, obteniendo así las <strong>Medias Cuadráticas</strong> (MS):</p>
<p><span class="math display">\[
\text{MSR} = \frac{\text{SSR}}{1} \quad \quad \quad \text{MSE} = \frac{\text{SSE}}{n-2}
\]</span></p>
<p>Finalmente, el <strong>estadístico F</strong> se construye como el cociente entre la variabilidad explicada por el modelo y la variabilidad no explicada:</p>
<p><span class="math display">\[
F = \frac{\text{MSR}}{\text{MSE}}
\]</span></p>
<p>Intuitivamente, el estadístico F actúa como una <strong>ratio de señal a ruido</strong>. La MSR (la “señal”) representa la variabilidad que nuestro modelo captura sistemáticamente, mientras que la MSE (el “ruido”) representa la variabilidad aleatoria o residual. Un valor de F grande nos dice que la señal es mucho más fuerte que el ruido, lo que apoya la hipótesis de que la relación que hemos modelado es real y no fruto del azar.</p>
<p>Toda esta información se organiza de forma estándar en la <strong>tabla ANOVA</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Fuente</th>
<th><span class="math inline">\(df\)</span></th>
<th><span class="math inline">\(SS\)</span></th>
<th><span class="math inline">\(MS = SS/df\)</span></th>
<th>Estadístico <span class="math inline">\(F\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regresión</td>
<td>1</td>
<td><span class="math inline">\(SSR\)</span></td>
<td><span class="math inline">\(MSR\)</span></td>
<td><span class="math inline">\(F = MSR/MSE\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(n-2\)</span></td>
<td><span class="math inline">\(SSE\)</span></td>
<td><span class="math inline">\(MSE\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(n-1\)</span></td>
<td><span class="math inline">\(SST\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Bajo la hipótesis nula (<span class="math inline">\(H_0: \beta_1 = 0\)</span>), el estadístico <span class="math inline">\(F\)</span> sigue una distribución <span class="math inline">\(F\)</span> con 1 y <span class="math inline">\(n-2\)</span> grados de libertad. Si el p-valor asociado a nuestro estadístico F es suficientemente pequeño (<span class="math inline">\(p &lt; \alpha\)</span>), rechazamos <span class="math inline">\(H_0\)</span> y concluimos que nuestro modelo tiene un poder explicativo estadísticamente significativo.</p>
</section>
<section id="bondad-del-ajuste-coeficiente-de-determinación" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="bondad-del-ajuste-coeficiente-de-determinación"><span class="header-section-number">2.4.4</span> Bondad del ajuste: coeficiente de determinación</h3>
<p>El coeficiente de determinación (<span class="math inline">\(R^2\)</span>) es una medida clave que cuantifica qué proporción de la variabilidad total observada en la muestra (<span class="math inline">\(y_i\)</span>) es explicada por la relación lineal con <span class="math inline">\(X\)</span> a través del modelo. Su fórmula se deriva de la descomposición de la varianza:</p>
<p><span class="math display">\[
R^2 = \frac{\text{SSR}}{\text{SST}} = 1 - \frac{\text{SSE}}{\text{SST}}
\]</span></p>
<p>Donde las sumas de cuadrados se calculan a partir de los datos muestrales:</p>
<ul>
<li><span class="math inline">\(\text{SST} = \sum_{i=1}^n (y_i - \bar{y})^2\)</span>: Suma Total de Cuadrados, mide la variabilidad total de las observaciones.</li>
<li><span class="math inline">\(\text{SSR} = \sum_{i=1}^n (\hat{y}_i - \bar{y})^2\)</span>: Suma de Cuadrados de la Regresión, mide la variabilidad explicada por el modelo.</li>
<li><span class="math inline">\(\text{SSE} = \sum_{i=1}^n (y_i - \hat{y}_i)^2\)</span>: Suma de Cuadrados del Error, mide la variabilidad no explicada (residual).</li>
</ul>
<p>Un <span class="math inline">\(R^2\)</span> cercano a 1 indica que el modelo ajusta bien los datos, mientras que un <span class="math inline">\(R^2\)</span> cercano a 0 indica un ajuste pobre.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Relación entre R² y el coeficiente de correlación">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relación entre R² y el coeficiente de correlación
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>En el caso específico del modelo de regresión lineal simple, existe una relación directa y simple: el coeficiente de determinación <span class="math inline">\(R^2\)</span> es literalmente el cuadrado del coeficiente de correlación de Pearson (<span class="math inline">\(r\)</span>) entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</p>
<p><span class="math display">\[ R^2 = (r_{xy})^2 \]</span></p>
<p>Esto refuerza la idea de que ambos miden la fuerza de la asociación <em>lineal</em>, aunque <span class="math inline">\(R^2\)</span> lo hace desde la perspectiva de la varianza explicada por el modelo.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Interpretación de R²">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretación de R²
</div>
</div>
<div class="callout-body-container callout-body">
<p>El coeficiente de determinación, <span class="math inline">\(R^2\)</span>, es una métrica muy popular, pero su interpretación requiere cautela. Un valor alto no garantiza un buen modelo, y un valor bajo no siempre implica un modelo inútil. Es fundamental tener en cuenta las siguientes observaciones:</p>
<ul>
<li><p><span class="math inline">\(R^2\)</span> no mide la linealidad de la relación. Un modelo puede tener un <span class="math inline">\(R^2\)</span> muy alto incluso si la relación subyacente entre las variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> no es lineal. Por ello, un <span class="math inline">\(R^2\)</span> elevado nunca debe sustituir a un análisis gráfico de los residuos para verificar el supuesto de linealidad.</p></li>
<li><p><span class="math inline">\(R^2\)</span> es sensible al rango de la variable predictora <span class="math inline">\(X\)</span>. Si el modelo de regresión es adecuado, la magnitud de <span class="math inline">\(R^2\)</span> aumentará si aumenta la dispersión de las observaciones <span class="math inline">\(x_i\)</span> (es decir, si <span class="math inline">\(S_{xx}\)</span> crece). Esto se debe a que un mayor rango en <span class="math inline">\(X\)</span> tiende a aumentar la Suma Total de Cuadrados (SST), lo que puede inflar el valor de <span class="math inline">\(R^2\)</span> sin que la precisión del modelo (medida por la MSE) haya mejorado.</p></li>
<li><p><strong>Un rango restringido en</strong> <span class="math inline">\(X\)</span> puede producir un <span class="math inline">\(R^2\)</span> artificialmente bajo. Como consecuencia del punto anterior, si los datos se han recogido en un rango muy estrecho de la variable <span class="math inline">\(X\)</span>, el <span class="math inline">\(R^2\)</span> puede ser muy pequeño, aunque exista una relación fuerte y significativa entre las variables. Esto podría llevar a la conclusión errónea de que el predictor no es útil.</p></li>
</ul>
</div>
</div>
</section>
<section id="inferencia-sobre-los-coeficientes" class="level3" data-number="2.4.5">
<h3 data-number="2.4.5" class="anchored" data-anchor-id="inferencia-sobre-los-coeficientes"><span class="header-section-number">2.4.5</span> Inferencia sobre los coeficientes</h3>
<p>Además de la prueba F global, podemos realizar inferencias sobre cada parámetro individualmente. Para ello, necesitamos el supuesto de normalidad de los errores.</p>
<section id="distribución-de-los-estimadores" class="level4" data-number="2.4.5.1">
<h4 data-number="2.4.5.1" class="anchored" data-anchor-id="distribución-de-los-estimadores"><span class="header-section-number">2.4.5.1</span> Distribución de los estimadores</h4>
<p>Bajo el supuesto de normalidad, se puede demostrar que los estimadores también siguen una distribución Normal: <span class="math display">\[
\hat{\beta}_1 \sim N\left(\beta_1, \frac{\sigma^2}{S_{xx}}\right) \quad \quad \quad \hat{\beta}_0 \sim N\left(\beta_0, \sigma^2 \left[ \frac{1}{n} + \frac{\bar{x}^2}{S_{xx}} \right]\right)
\]</span></p>
<p>Al estandarizar y reemplazar la desconocida <span class="math inline">\(\sigma^2\)</span> por su estimador <span class="math inline">\(\hat{\sigma}^2 = \text{MSE}\)</span>, obtenemos un estadístico que sigue una distribución t-Student con <span class="math inline">\(n-2\)</span> grados de libertad: <span class="math display">\[
t = \frac{\hat{\beta}_1 - \beta_1}{\text{SE}(\hat{\beta}_1)} \sim t_{n-2}
\]</span> donde <span class="math inline">\(\text{SE}(\hat{\beta}_1) = \sqrt{\frac{\text{MSE}}{S_{xx}}}\)</span> es el <strong>error estándar</strong> del estimador <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
</section>
<section id="contraste-de-hipótesis-para-la-pendiente" class="level4" data-number="2.4.5.2">
<h4 data-number="2.4.5.2" class="anchored" data-anchor-id="contraste-de-hipótesis-para-la-pendiente"><span class="header-section-number">2.4.5.2</span> Contraste de hipótesis para la pendiente</h4>
<p>El contraste más común es el de la significancia de la pendiente: * <span class="math inline">\(H_0: \beta_1 = 0\)</span> * <span class="math inline">\(H_1: \beta_1 \neq 0\)</span></p>
<p>Bajo <span class="math inline">\(H_0\)</span>, el estadístico de contraste es: <span class="math display">\[
t_0 = \frac{\hat{\beta}_1}{\text{SE}(\hat{\beta}_1)}
\]</span> Rechazamos <span class="math inline">\(H_0\)</span> si <span class="math inline">\(|t_0| &gt; t_{\alpha/2, n-2}\)</span> o, equivalentemente, si el p-valor asociado es menor que <span class="math inline">\(\alpha\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Relación entre el contraste F y el contraste t">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relación entre el contraste F y el contraste t
</div>
</div>
<div class="callout-body-container callout-body">
<p>En el contexto de la <strong>regresión lineal simple</strong> (y solo en este caso), el contraste F para la significancia global del modelo es matemáticamente equivalente al contraste t para la significancia del coeficiente <span class="math inline">\(\beta_1\)</span>. Se puede demostrar que <span class="math inline">\(F = t^2\)</span>, y el p-valor de ambos contrastes será idéntico.</p>
</div>
</div>
</section>
<section id="intervalo-de-confianza-para-la-pendiente" class="level4" data-number="2.4.5.3">
<h4 data-number="2.4.5.3" class="anchored" data-anchor-id="intervalo-de-confianza-para-la-pendiente"><span class="header-section-number">2.4.5.3</span> Intervalo de confianza para la pendiente</h4>
<p>A partir de la distribución t, podemos construir un intervalo de confianza al <span class="math inline">\(100(1-\alpha)\%\)</span> para el verdadero valor de la pendiente <span class="math inline">\(\beta_1\)</span>: <span class="math display">\[
\hat{\beta}_1 \pm t_{\alpha/2, n-2} \cdot \text{SE}(\hat{\beta}_1)
\]</span> Este intervalo nos da un rango de valores plausibles para el efecto de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span>. Si el intervalo no contiene el cero, es equivalente a rechazar la hipótesis nula <span class="math inline">\(H_0: \beta_1 = 0\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Para recordar">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Para recordar
</div>
</div>
<div class="callout-body-container callout-body">
<p>En los programas estadísticos se suele proporcionar el p-valor del contraste. Puedes repasar el significado de p-valor proporcionado en la asignatura de Inferencia.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Interpretación del `summary`">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Interpretación del <code>summary</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La función <code>summary()</code> en R nos proporciona toda esta información.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_estudio)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Calificaciones ~ Tiempo_Estudio, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.11465 -0.30262 -0.00942  0.29509  1.10533 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     5.00118    0.11977   41.76   &lt;2e-16 ***
Tiempo_Estudio  0.09875    0.00488   20.23   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4842 on 98 degrees of freedom
Multiple R-squared:  0.8069,    Adjusted R-squared:  0.8049 
F-statistic: 409.5 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong></p>
<ul>
<li><strong>Coefficients</strong>: El p-valor para <code>Tiempo_Estudio</code> (&lt;0.001) es muy pequeño, por lo que rechazamos <span class="math inline">\(H_0\)</span> y concluimos que la variable es un predictor significativo.</li>
<li><strong>R-squared</strong>: El valor de <span class="math inline">\(R^2\)</span> (0.81) nos indica que el 81% de la variabilidad en las calificaciones es explicada por el tiempo de estudio.</li>
<li><strong>F-statistic</strong>: El p-valor del estadístico F
<ol start="98" type="1">
<li>confirma que el modelo en su conjunto es estadísticamente significativo.</li>
</ol></li>
</ul>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="predicción-de-nuevas-observaciones" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="predicción-de-nuevas-observaciones"><span class="header-section-number">2.5</span> Predicción de nuevas observaciones</h2>
<p>Una vez que hemos ajustado y validado un modelo de regresión, uno de sus propósitos más importantes es utilizarlo para hacer predicciones. Sin embargo, es fundamental distinguir entre dos tipos de predicción:</p>
<ol type="1">
<li><strong>Estimar la respuesta media</strong> para un valor dado de <span class="math inline">\(X\)</span>. Por ejemplo: “¿Cuál es la calificación <em>promedio</em> que esperamos para todos los estudiantes que estudian 25 horas semanales?”.</li>
<li><strong>Predecir una respuesta individual</strong> para un valor dado de <span class="math inline">\(X\)</span>. Por ejemplo: “Si un estudiante <em>concreto</em> estudia 25 horas semanales, ¿entre qué valores esperamos que se encuentre su calificación?”.</li>
</ol>
<p>Estos dos objetivos, aunque parecidos, responden a preguntas distintas y manejan diferentes fuentes de incertidumbre, lo que da lugar a dos tipos de intervalos.</p>
<section id="intervalo-de-confianza-para-la-respuesta-media" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="intervalo-de-confianza-para-la-respuesta-media"><span class="header-section-number">2.5.1</span> Intervalo de confianza para la respuesta media</h3>
<p>Este intervalo estima el valor esperado de <span class="math inline">\(Y\)</span> para un valor concreto del regresor, <span class="math inline">\(x_0\)</span>. Su objetivo es acotar dónde se encuentra la <strong>línea de regresión poblacional verdadera</strong> para ese punto <span class="math inline">\(x_0\)</span>. La estimación puntual es <span class="math inline">\(\hat{y}_0 = \hat{\beta}_0 + \hat{\beta}_1 x_0\)</span>.</p>
<p>El intervalo de confianza al <span class="math inline">\(100(1-\alpha)\%\)</span> para la respuesta media <span class="math inline">\(E[Y|X=x_0]\)</span> viene dado por:</p>
<p><span class="math display">\[
\hat{y}_0 \pm t_{\alpha/2, n-2} \cdot \sqrt{\text{MSE} \left( \frac{1}{n} + \frac{(x_0 - \bar{x})^2}{S_{xx}} \right)}
\]</span></p>
<p>La anchura de este intervalo depende de dos fuentes de error: la incertidumbre en la estimación de la recta y la distancia del punto <span class="math inline">\(x_0\)</span> a la media <span class="math inline">\(\bar{x}\)</span>. El intervalo es más estrecho cerca del centro de los datos y más ancho en los extremos.</p>
</section>
<section id="intervalo-de-predicción-para-una-respuesta-individual" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="intervalo-de-predicción-para-una-respuesta-individual"><span class="header-section-number">2.5.2</span> Intervalo de predicción para una respuesta individual</h3>
<p>Este intervalo es el que debemos usar cuando queremos predecir el valor para <strong>una única observación futura</strong>, no para la media. Como indicas, este intervalo debe tener en cuenta dos fuentes de variabilidad:</p>
<ol type="1">
<li>La incertidumbre sobre la localización de la verdadera recta de regresión (la misma que en el intervalo de confianza).</li>
<li>La variabilidad inherente de una observación individual alrededor de la recta de regresión (el error aleatorio <span class="math inline">\(\varepsilon_i\)</span>, cuya varianza estimamos con la MSE).</li>
</ol>
<p>Por esta razón, el intervalo de predicción <strong>siempre será más ancho</strong> que el intervalo de confianza para la respuesta media. El intervalo de predicción al <span class="math inline">\(100(1-\alpha)\%\)</span> para una observación futura <span class="math inline">\(y_0\)</span> en el punto <span class="math inline">\(x_0\)</span> es:</p>
<p><span class="math display">\[
\hat{y}_0 \pm t_{\alpha/2, n-2} \cdot \sqrt{\text{MSE} \left( 1 + \frac{1}{n} + \frac{(x_0 - \bar{x})^2}{S_{xx}} \right)}
\]</span></p>
<p>La única diferencia matemática es el <strong>“+1”</strong> dentro de la raíz cuadrada, que representa la varianza <span class="math inline">\(\sigma^2\)</span> del error de una sola observación.</p>
<section id="predicción-para-la-media-de-m-observaciones-futuras" class="level4" data-number="2.5.2.1">
<h4 data-number="2.5.2.1" class="anchored" data-anchor-id="predicción-para-la-media-de-m-observaciones-futuras"><span class="header-section-number">2.5.2.1</span> Predicción para la media de <em>m</em> observaciones futuras</h4>
<p>Si se desea un intervalo de predicción para la media de <em>m</em> futuras observaciones en un valor <span class="math inline">\(x_0\)</span>, la fórmula se modifica ligeramente. Este intervalo será más estrecho que el de una sola observación pero más ancho que el de la respuesta media:</p>
<p><span class="math display">\[
\hat{y}_0 \pm t_{\alpha/2, n-2} \cdot \sqrt{\text{MSE} \left( \frac{1}{m} + \frac{1}{n} + \frac{(x_0 - \bar{x})^2}{S_{xx}} \right)}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo práctico: Predicción de calificaciones">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo práctico: Predicción de calificaciones
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a calcular y visualizar los intervalos para nuestro modelo de estudio. Usaremos la función <code>predict()</code> de R, que calcula estos intervalos de forma automática.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear una secuencia de nuevos valores de X para predecir</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>nuevos_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tiempo_Estudio =</span> <span class="fu">seq</span>(<span class="fu">min</span>(datos<span class="sc">$</span>Tiempo_Estudio), <span class="fu">max</span>(datos<span class="sc">$</span>Tiempo_Estudio), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calcular el intervalo de confianza para la RESPUESTA MEDIA</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  modelo_estudio, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> nuevos_datos, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"confidence"</span>, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Calcular el intervalo de predicción para una OBSERVACIÓN INDIVIDUAL</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>pred_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  modelo_estudio, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> nuevos_datos, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">"prediction"</span>, </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Unir todo para graficar con ggplot2</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nuevos_datos, <span class="fu">as.data.frame</span>(conf_interval), <span class="at">pred_pred =</span> <span class="fu">as.data.frame</span>(pred_interval))</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Tiempo_Estudio"</span>, <span class="st">"fit_conf"</span>, <span class="st">"lwr_conf"</span>, <span class="st">"upr_conf"</span>, <span class="st">"fit_pred"</span>, <span class="st">"lwr_pred"</span>, <span class="st">"upr_pred"</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Visualización</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Capa 1: Puntos originales del dataframe 'datos'</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> datos, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo_Estudio, <span class="at">y =</span> Calificaciones), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Capa 2: Línea de regresión del dataframe 'plot_data'</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo_Estudio, <span class="at">y =</span> fit_conf), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Capa 3: Banda de predicción (roja) del dataframe 'plot_data'</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo_Estudio, <span class="at">ymin =</span> lwr_pred, <span class="at">ymax =</span> upr_pred), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Capa 4: Banda de confianza (azul) del dataframe 'plot_data'</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo_Estudio, <span class="at">ymin =</span> lwr_conf, <span class="at">ymax =</span> upr_conf), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Etiquetas y tema</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Intervalos de Confianza y Predicción"</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Tiempo de Estudio (horas/semana)"</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Calificaciones (promedio)"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"La banda azul (más estrecha) es el IC del 95% para la media.</span><span class="sc">\n</span><span class="st">La banda roja (más ancha) es el IP del 95% para una nueva observación."</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prediccion" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-prediccion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-prediccion-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prediccion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.2: Comparación visual del intervalo de confianza (azul, más estrecho) y el intervalo de predicción (rojo, más ancho).
</figcaption>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra claramente que la incertidumbre al predecir una calificación individual es mucho mayor que la incertidumbre al estimar la calificación promedio. Ambas bandas se ensanchan al alejarse del centro de los datos.</p>
<p>Si quisiéramos una predicción para un estudiante que estudia 25 horas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dato_nuevo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tiempo_Estudio =</span> <span class="dv">25</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardamos la predicción para la media en un objeto</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>pred_media <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_estudio, <span class="at">newdata =</span> dato_nuevo, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardamos la predicción para un individuo en un objeto</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>pred_indiv <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_estudio, <span class="at">newdata =</span> dato_nuevo, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretación:</strong></p>
<ul>
<li>Con un 95% de confianza, la calificación <strong>promedio</strong> de los estudiantes que estudian 25 horas está entre <strong>7.37</strong> y <strong>7.57</strong>.</li>
<li>Con un 95% de confianza, la calificación de <strong>un estudiante concreto</strong> que estudia 25 horas estará entre <strong>6.5</strong> y <strong>8.44</strong>.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="diagnóstico-del-modelo" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="diagnóstico-del-modelo"><span class="header-section-number">2.6</span> Diagnóstico del Modelo</h2>
<p>Una vez que hemos ajustado un modelo y evaluado su significancia, el trabajo no ha terminado. Un paso crucial, a menudo subestimado, es el <strong>diagnóstico del modelo</strong> <span class="citation" data-cites="fox2018r harrell2015">(<a href="references.html#ref-fox2018r" role="doc-biblioref">Fox y Weisberg 2018</a>; <a href="references.html#ref-harrell2015" role="doc-biblioref">Harrell 2015</a>)</span>. Este proceso consiste en verificar si se cumplen los supuestos del modelo de regresión lineal clásico. La fiabilidad de nuestras inferencias (los p-valores de los contrastes t y F, y los intervalos de confianza) depende directamente de la validez de estos supuestos.</p>
<p>El diagnóstico se realiza principalmente a través del <strong>análisis de los residuos</strong> del modelo (<span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>). Los residuos son nuestra mejor aproximación empírica de los errores teóricos no observables (<span class="math inline">\(\varepsilon_i\)</span>). A continuación, se detalla cómo verificar cada uno de los supuestos clave.</p>
<section id="linealidad" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="linealidad"><span class="header-section-number">2.6.1</span> Linealidad</h3>
<p>Este supuesto establece que la relación entre la variable predictora <span class="math inline">\(X\)</span> y el valor esperado de la variable respuesta <span class="math inline">\(Y\)</span> es, en promedio, una línea recta: <span class="math inline">\(E[Y | X] = \beta_0 + \beta_1 X\)</span>.</p>
<p>La herramienta fundamental para diagnosticar la linealidad es el gráfico de <strong>residuos</strong> (<span class="math inline">\(e_i\)</span>) frente a los <strong>valores ajustados</strong> por el modelo (<span class="math inline">\(\hat{y}_i\)</span>). La lógica de este gráfico es sencilla pero potente: si el modelo lineal es adecuado, los errores que comete (los residuos) deberían ser completamente aleatorios, sin guardar relación alguna con la magnitud de las predicciones. En esencia, buscamos confirmar que no queda ninguna información sistemática en los errores que el modelo no haya capturado.</p>
<p><strong>En un escenario ideal</strong>, este gráfico debería parecer una nube de puntos distribuida horizontalmente y sin estructura aparente, centrada en la línea del cero. Esto nos indica que los errores son, en promedio, nulos para todos los niveles de predicción, cumpliendo así el supuesto de linealidad. La línea roja que R superpone en este gráfico, que suaviza la tendencia de los puntos, debería ser prácticamente plana y pegada al cero, confirmando la ausencia de patrones.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo de un modelo válido">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de un modelo válido
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Para nuestro <code>modelo_estudio</code>, podemos generar específicamente el primer gráfico de diagnóstico, que es el de Residuos vs.&nbsp;Valores Ajustados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un dataframe con los datos para ggplot2</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer residuos y valores ajustados</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>datos_diagnostico <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos =</span> <span class="fu">residuals</span>(modelo_estudio),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores_ajustados =</span> <span class="fu">fitted</span>(modelo_estudio)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de Residuos vs. Valores Ajustados con ggplot2</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_diagnostico, <span class="fu">aes</span>(<span class="at">x =</span> valores_ajustados, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuos vs. Valores Ajustados"</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos"</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linealidad-ok" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linealidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-linealidad-ok-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linealidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.3: Gráfico de Residuos vs.&nbsp;Valores Ajustados para el modelo de estudio. No se observan patrones.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Como se puede observar, los puntos se distribuyen de forma aleatoria alrededor de la línea horizontal en cero. La línea roja, que suaviza la tendencia de los residuos, es prácticamente plana. Esto es un claro indicativo de que el supuesto de linealidad se cumple en nuestro modelo.</p>
</div>
</div>
</div>
<p>Por el contrario, la aparición de un <strong>patrón sistemático</strong> en los residuos es la señal de alarma de que algo anda mal. En lo que respecta al supuesto de <strong>linealidad</strong>, la evidencia más clara de una violación es una <strong>tendencia curvilínea</strong> (como una “U” o una parábola). Este patrón nos dice que el modelo es estructuralmente incapaz de capturar la forma de los datos y, por lo tanto, comete errores predecibles. Por ejemplo, puede subestimar la respuesta en los extremos (generando residuos positivos) y sobreestimarla en el centro (residuos negativos), lo que invalida el modelo lineal.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Contraejemplo: Violación del supuesto de linealidad">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contraejemplo: Violación del supuesto de linealidad
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Ahora, vamos a simular a propósito unos datos que siguen una relación cuadrática (curva) y ajustaremos incorrectamente un modelo lineal para ver cómo se manifiesta el problema en el gráfico de diagnóstico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simulación de datos no lineales</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Nueva semilla para este ejemplo</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x_no_lineal <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># La relación verdadera es cuadrática (y = 10 - (x-5)^2) más un error</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>y_no_lineal <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> (x_no_lineal <span class="sc">-</span> <span class="dv">5</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>datos_no_lineal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_no_lineal, <span class="at">y =</span> y_no_lineal)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ajuste de un modelo lineal (incorrecto)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>modelo_no_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos_no_lineal)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Gráfico de Residuos vs. Valores Ajustados con ggplot2</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>datos_diag_no_lineal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos =</span> <span class="fu">residuals</span>(modelo_no_lineal),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores_ajustados =</span> <span class="fu">fitted</span>(modelo_no_lineal)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_diag_no_lineal, <span class="fu">aes</span>(<span class="at">x =</span> valores_ajustados, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuos vs. Valores Ajustados (Violación de Linealidad)"</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos"</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linealidad-mal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linealidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-linealidad-mal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linealidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.4: Patrón curvo evidente en los residuos, violando el supuesto de linealidad.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El gráfico de diagnóstico es inequívoco. A diferencia del ejemplo anterior, donde los puntos formaban una nube aleatoria, aquí los residuos dibujan un <strong>patrón parabólico</strong> perfecto (una “U” invertida). La línea roja de tendencia, en lugar de ser plana, sigue fielmente esta curva.</p>
</div>
</div>
</div>
</section>
<section id="homocedasticidad" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="homocedasticidad"><span class="header-section-number">2.6.2</span> Homocedasticidad</h3>
<p>El supuesto de homocedasticidad establece que la varianza de los errores del modelo debe ser constante para todos los niveles de la variable predictora. Es decir, la dispersión de los datos alrededor de la línea de regresión es la misma en todo su recorrido (<span class="math inline">\(Var(\varepsilon_i | X_i) = \sigma^2\)</span>). La violación de este supuesto se conoce como <strong>heteroscedasticidad</strong>, y es un problema común en el modelado.</p>
<p>¿Por qué es tan importante? Si un modelo es heteroscedástico, los errores estándar de los coeficientes (<span class="math inline">\(\beta_0, \beta_1\)</span>) estarán calculados de forma incorrecta. Como consecuencia, los intervalos de confianza y los contrastes de hipótesis (p-valores) no serán fiables, pudiendo llevarnos a conclusiones erróneas sobre la significancia de nuestras variables.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Sobre los residuos estandarizados">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sobre los residuos estandarizados
</div>
</div>
<div class="callout-body-container callout-body">
<p>Los <strong>residuos simples</strong> (<span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>) no son directamente comparables entre sí porque tienen diferentes varianzas dependiendo de su apalancamiento (<em>leverage</em>). Por eso, en los gráficos de diagnóstico se utilizan <strong>residuos estandarizados</strong> o, mejor aún, <strong>residuos estudentizados</strong>, que ponen todos los residuos en una escala común. Esto facilita la identificación de patrones y valores atípicos. La explicación detallada de estos conceptos se encuentra en la sección de identificación de observaciones influyentes.</p>
</div>
</div>
<p>La heteroscedasticidad se detecta principalmente buscando patrones en la dispersión de los residuos.</p>
<ul>
<li><p><strong>Gráfico de Residuos vs.&nbsp;Valores Ajustados:</strong> Como en la prueba de linealidad, este gráfico es nuestra primera herramienta. Aquí no buscamos patrones en la media de los residuos (que debe ser cero), sino en su <strong>dispersión</strong>. La señal de alarma inequívoca de heteroscedasticidad es una <strong>forma de embudo o megáfono</strong>, donde la dispersión de los residuos aumenta o disminuye a medida que cambian los valores ajustados.</p></li>
<li><p><strong>Gráfico Scale-Location:</strong> Este gráfico está diseñado específicamente para detectar heteroscedasticidad. Muestra la raíz cuadrada de los residuos estandarizados en el eje Y (<code>sqrt(|Standardized residuals|)</code>) frente a los valores ajustados en el eje X. Al usar la raíz cuadrada, se suaviza la distribución de los residuos, haciendo los patrones de varianza más fáciles de ver. Si la varianza es constante (homocedasticidad), deberíamos ver una nube de puntos aleatoria con una línea de tendencia roja aproximadamente plana. Una pendiente en esta línea roja indica que la varianza cambia con el nivel de la respuesta.</p></li>
<li><p><strong>Prueba de Breusch-Pagan:</strong> Es el contraste de hipótesis formal. Su lógica es ingeniosa: realiza una regresión auxiliar donde intenta predecir los residuos al cuadrado a partir de las variables predictoras originales. Si las variables predictoras ayudan a explicar la magnitud de los residuos al cuadrado, significa que la varianza del error depende de los predictores, y por tanto, hay heteroscedasticidad.</p>
<ul>
<li><strong>Hipótesis Nula (</strong><span class="math inline">\(H_0\)</span>): El modelo es homocedástico.</li>
<li><strong>Decisión:</strong> Un p-valor pequeño (p.&nbsp;ej., &lt; 0.05) es evidencia en contra de la homocedasticidad.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo de un modelo válido">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de un modelo válido
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Analicemos nuestro <code>modelo_estudio</code>. Nos centraremos en el gráfico <code>Scale-Location</code> (<code>which = 3</code>) y en la prueba de Breusch-Pagan.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos para el gráfico Scale-Location</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>datos_scale_loc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores_ajustados =</span> <span class="fu">fitted</span>(modelo_estudio),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos_std_sqrt =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(modelo_estudio)))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico Scale-Location con ggplot2</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_scale_loc, <span class="fu">aes</span>(<span class="at">x =</span> valores_ajustados, <span class="at">y =</span> residuos_std_sqrt)) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scale-Location"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">sqrt</span>(<span class="st">"|Residuos Estandarizados|"</span>))</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Breusch-Pagan</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_estudio)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_estudio
BP = 0.019638, df = 1, p-value = 0.8886</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-homocedasticidad-ok" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-homocedasticidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-homocedasticidad-ok-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-homocedasticidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.5: Gráfico Scale-Location para el modelo de estudio. La línea de tendencia es casi plana.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El diagnóstico es positivo. En el gráfico <code>Scale-Location</code>, la línea roja es casi horizontal, lo que indica que la varianza de los residuos es estable a lo largo de los valores ajustados. Esto se confirma con la prueba de Breusch-Pagan, que arroja un <strong>p-valor alto</strong>, por lo que no tenemos evidencia para rechazar la hipótesis nula de homocedasticidad. <strong>Nuestro modelo cumple el supuesto</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Contraejemplo: Violación del supuesto de homocedasticidad">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contraejemplo: Violación del supuesto de homocedasticidad
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Ahora, simularemos datos donde el error aumenta a medida que <code>x</code> crece, un caso clásico de heteroscedasticidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simulación de datos heteroscedásticos</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>x_hetero <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>y_hetero <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x_hetero <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.4</span> <span class="sc">*</span> x_hetero)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>datos_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_hetero, <span class="at">y =</span> y_hetero)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>modelo_hetero <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos_hetero)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Preparar datos para los gráficos</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>datos_diag_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos =</span> <span class="fu">residuals</span>(modelo_hetero),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">valores_ajustados =</span> <span class="fu">fitted</span>(modelo_hetero),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos_std_sqrt =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">rstandard</span>(modelo_hetero)))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Gráfico de Residuos vs. Valores Ajustados</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_diag_hetero, <span class="fu">aes</span>(<span class="at">x =</span> valores_ajustados, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuos vs. Valores Ajustados"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos"</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Gráfico Scale-Location</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_diag_hetero, <span class="fu">aes</span>(<span class="at">x =</span> valores_ajustados, <span class="at">y =</span> residuos_std_sqrt)) <span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scale-Location"</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">sqrt</span>(<span class="st">"|Residuos Estandarizados|"</span>))</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Mostrar ambos gráficos lado a lado</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Prueba de Breusch-Pagan</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>test_values <span class="ot">&lt;-</span> <span class="fu">bptest</span>(modelo_hetero)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-homocedasticidad-mal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-homocedasticidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-homocedasticidad-mal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-homocedasticidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.6: Diagnóstico de heteroscedasticidad. Izquierda: Gráfico de Residuos vs.&nbsp;Ajustados (patrón de embudo). Derecha: Gráfico Scale-Location (tendencia ascendente).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Los resultados son un libro de texto sobre la heteroscedasticidad.</p>
<ul>
<li>El gráfico de <strong>Residuos vs.&nbsp;Valores Ajustados</strong> (izquierda) tiene una <strong>forma de embudo</strong> inconfundible: la dispersión de los puntos aumenta drásticamente de izquierda a derecha.</li>
<li>El gráfico <strong>Scale-Location</strong> (derecha) confirma el problema, mostrando una línea roja con una <strong>clara pendiente ascendente</strong>.</li>
<li>La <strong>prueba de Breusch-Pagan</strong> arroja un <strong>p-valor 7.43e-07</strong>, dándonos una fuerte evidencia estadística para rechazar la hipótesis nula de homocedasticidad.</li>
</ul>
<p>Este modelo viola claramente el supuesto, y las inferencias basadas en él (como el p-valor del coeficiente de <code>x</code>) no serían fiables.</p>
</div>
</div>
</div>
</section>
<section id="normalidad-de-los-residuos" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="normalidad-de-los-residuos"><span class="header-section-number">2.6.3</span> Normalidad de los residuos</h3>
<p>Este supuesto postula que los residuos del modelo (<span class="math inline">\(\varepsilon_i\)</span>) siguen una distribución normal: <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span>. Es especialmente importante para la validez de los intervalos de confianza y los contrastes de hipótesis cuando el tamaño de la muestra es pequeño.</p>
<p>Para evaluar la normalidad disponemos de herramientas visuales y analíticas:</p>
<ul>
<li><strong>Gráfico Normal Q-Q (<code>Normal Q-Q Plot</code>):</strong> Compara los cuantiles de los residuos estandarizados con los cuantiles de una distribución normal teórica. Los puntos deben caer muy cerca de la línea diagonal de 45 grados.</li>
<li><strong>Histograma de los Residuos:</strong> Un simple histograma de los residuos debe mostrar una forma aproximada de campana de Gauss.</li>
<li><strong>Prueba de Shapiro-Wilk:</strong> Es uno de los contrastes más potentes para la normalidad.
<ul>
<li><strong>Hipótesis Nula (</strong><span class="math inline">\(H_0\)</span>): Los residuos provienen de una distribución normal.</li>
<li><strong>Decisión:</strong> Un p-valor pequeño (&lt; 0.05) sugiere rechazar <span class="math inline">\(H_0\)</span>.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo de normalidad válida">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de normalidad válida
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Para nuestro <code>modelo_estudio</code>, examinamos la normalidad mediante el gráfico Q-Q y la prueba de Shapiro-Wilk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos para los gráficos</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>residuos <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_estudio)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Gráfico Q-Q con ggplot2</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>datos_qq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_qq, <span class="fu">aes</span>(<span class="at">sample =</span> residuos)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cuantiles Teóricos"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cuantiles de la Muestra"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Histograma con ggplot2</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>datos_hist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_hist, <span class="fu">aes</span>(<span class="at">x =</span> residuos)) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(residuos), <span class="at">sd =</span> <span class="fu">sd</span>(residuos)),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histograma de Residuos"</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Residuos"</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Densidad"</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mostrar ambos gráficos lado a lado</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Shapiro-Wilk</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>shapiro_resultado <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelo_estudio))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-normalidad-ok" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normalidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-normalidad-ok-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normalidad-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.7: Diagnóstico de normalidad del modelo de estudio. Izquierda: Q-Q Plot. Derecha: Histograma de residuos.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El diagnóstico es excelente. En el gráfico Q-Q, los puntos se alinean muy bien con la línea diagonal, indicando normalidad. El histograma muestra una distribución aproximadamente simétrica que se ajusta bien a la curva normal teórica (línea roja). La prueba de Shapiro-Wilk confirma esto con un <strong>p-valor alto</strong> (6.71e-01), por lo que no rechazamos la hipótesis nula de normalidad.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Contraejemplo: Violación del supuesto de normalidad">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contraejemplo: Violación del supuesto de normalidad
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Ahora simularemos datos donde los residuos siguen una distribución asimétrica (distribución exponencial) para mostrar una violación clara del supuesto de normalidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simulación de datos con errores no normales (exponenciales)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>x_no_normal <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Errores exponenciales (muy asimétricos) centrados en 0</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>errores_exp <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="at">rate =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Restamos 1 para centrar en 0</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>y_no_normal <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x_no_normal <span class="sc">+</span> errores_exp <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>datos_no_normal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_no_normal, <span class="at">y =</span> y_no_normal)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>modelo_no_normal <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos_no_normal)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Crear datos para los gráficos</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>residuos_no_normal <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_no_normal)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Gráfico Q-Q con ggplot2</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>datos_qq_mal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos_no_normal)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>p1_mal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_qq_mal, <span class="fu">aes</span>(<span class="at">sample =</span> residuos)) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Normal Q-Q Plot (Violación)"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cuantiles Teóricos"</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cuantiles de la Muestra"</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Histograma con ggplot2</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>datos_hist_mal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos_no_normal)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>p2_mal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_hist_mal, <span class="fu">aes</span>(<span class="at">x =</span> residuos)) <span class="sc">+</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"lightcoral"</span>, </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(residuos_no_normal), <span class="at">sd =</span> <span class="fu">sd</span>(residuos_no_normal)),</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histograma de Residuos (Violación)"</span>,</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Residuos"</span>,</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Densidad"</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Mostrar ambos gráficos lado a lado</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1_mal, p2_mal, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Shapiro-Wilk</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>shapiro_resultado <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelo_no_normal))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-normalidad-mal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normalidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-normalidad-mal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normalidad-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.8: Violación del supuesto de normalidad. Izquierda: Q-Q Plot con clara desviación. Derecha: Histograma asimétricamente distribuido.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La violación es evidente. En el gráfico Q-Q, los puntos se desvían sistemáticamente de la línea diagonal, especialmente en los extremos, formando una curva característica de distribuciones asimétricas. El histograma muestra una clara asimetría hacia la derecha que no se ajusta a la curva normal teórica (línea azul). La prueba de Shapiro-Wilk arroja un <strong>p-valor muy pequeño</strong> (1.78e-10), rechazando fuertemente la hipótesis nula de normalidad.</p>
</div>
</div>
</div>
</section>
<section id="independencia-de-los-residuos" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="independencia-de-los-residuos"><span class="header-section-number">2.6.4</span> Independencia de los residuos</h3>
<p>Este supuesto afirma que el error de una observación no está correlacionado con el de ninguna otra: <span class="math inline">\(Cov(\varepsilon_i, \varepsilon_j) = 0\)</span> para <span class="math inline">\(i \neq j\)</span>. La violación, conocida como <strong>autocorrelación</strong>, es común en datos de series temporales.</p>
<p>La <strong>Prueba de Durbin-Watson</strong> es el contraste clásico para la autocorrelación de primer orden. Su estadístico se calcula como: <span class="math display">\[ DW = \frac{\sum_{i=2}^{n}(e_i - e_{i-1})^2}{\sum_{i=1}^{n}e_i^2} \]</span> El estadístico varía entre 0 y 4. Un valor cercano a 2 sugiere no autocorrelación. Valores cercanos a 0 indican autocorrelación positiva, y cercanos a 4, autocorrelación negativa.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo de independencia válida">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de independencia válida
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Para nuestro <code>modelo_estudio</code>, evaluamos la independencia mediante el gráfico de residuos vs orden y la prueba de Durbin-Watson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de residuos vs orden de observación con ggplot2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>datos_orden <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">orden =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">residuals</span>(modelo_estudio)),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos =</span> <span class="fu">residuals</span>(modelo_estudio)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_orden, <span class="fu">aes</span>(<span class="at">x =</span> orden, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuos vs Orden de Observación"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Orden de observación"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos"</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Durbin-Watson</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>dw_resultado_valido <span class="ot">&lt;-</span> <span class="fu">dwtest</span>(modelo_estudio)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-independencia-ok" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-independencia-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-independencia-ok-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-independencia-ok-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.9: Diagnóstico de independencia del modelo de estudio. Los residuos no muestran patrones temporales.
</figcaption>
</figure>
</div>
</div>
</div>
<p>El diagnóstico es satisfactorio. El gráfico de residuos vs orden no muestra ningún patrón sistemático o tendencia temporal, los puntos fluctúan aleatoriamente alrededor del cero. La prueba de Durbin-Watson arroja un estadístico de <strong>2.056</strong> (cercano a 2) y un <strong>p-valor de 0.61</strong>, confirmando que no hay evidencia de autocorrelación. <strong>El supuesto de independencia se cumple</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Contraejemplo: Violación del supuesto de independencia">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contraejemplo: Violación del supuesto de independencia
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Simularemos datos con autocorrelación positiva, donde cada residuo está correlacionado con el anterior, violando el supuesto de independencia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simulación de datos con autocorrelación</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>x_autocorr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos errores autocorrelacionados (AR1 con phi = 0.7)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>errores_autocorr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>errores_autocorr[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  errores_autocorr[i] <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="sc">*</span> errores_autocorr[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>y_autocorr <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x_autocorr <span class="sc">+</span> errores_autocorr <span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>datos_autocorr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_autocorr, <span class="at">y =</span> y_autocorr)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>modelo_autocorr <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> datos_autocorr)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Gráfico de residuos vs orden con ggplot2</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>datos_orden_autocorr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">orden =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">residuals</span>(modelo_autocorr)),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos =</span> <span class="fu">residuals</span>(modelo_autocorr)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_orden_autocorr, <span class="fu">aes</span>(<span class="at">x =</span> orden, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuos vs Orden de Observación (Violación)"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Orden de observación"</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos"</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Prueba de Durbin-Watson</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>dw_resultado <span class="ot">&lt;-</span> <span class="fu">dwtest</span>(modelo_autocorr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-independencia-mal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-independencia-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-independencia-mal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-independencia-mal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.10: Violación del supuesto de independencia. Los residuos muestran un patrón de autocorrelación positiva.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La violación es clara. El gráfico de residuos vs orden muestra un patrón ondulante característico: los residuos tienden a mantenerse del mismo signo durante varias observaciones consecutivas (rachas de valores positivos seguidas de rachas de valores negativos). Esto indica <strong>autocorrelación positiva</strong>. La prueba de Durbin-Watson confirma esto con un estadístico muy por debajo de 2 (DW = <strong>0.74</strong>) y un <strong>p-valor muy pequeño</strong> (<strong>5.01e-11</strong>), rechazando fuertemente la hipótesis nula de independencia.</p>
</div>
</div>
</div>
</section>
<section id="media-nula-de-los-residuos" class="level3" data-number="2.6.5">
<h3 data-number="2.6.5" class="anchored" data-anchor-id="media-nula-de-los-residuos"><span class="header-section-number">2.6.5</span> Media nula de los residuos</h3>
<p>Un requisito fundamental del modelo es que la media de los residuos debe ser exactamente cero: <span class="math inline">\(E[e_i] = 0\)</span>. Esta propiedad se deriva matemáticamente del método de mínimos cuadrados y su verificación sirve como una comprobación de que nuestros cálculos son correctos.</p>
</section>
<section id="identificación-de-observaciones-influyentes-y-atípicas" class="level3" data-number="2.6.6">
<h3 data-number="2.6.6" class="anchored" data-anchor-id="identificación-de-observaciones-influyentes-y-atípicas"><span class="header-section-number">2.6.6</span> Identificación de observaciones influyentes y atípicas</h3>
<p>Algunos puntos pueden tener una influencia desproporcionada en el modelo. Es crucial identificarlos usando diferentes métricas que evalúan aspectos complementarios de la influencia <span class="citation" data-cites="kutner2005applied fox2018r">(<a href="references.html#ref-kutner2005applied" role="doc-biblioref">Kutner et&nbsp;al. 2005</a>; <a href="references.html#ref-fox2018r" role="doc-biblioref">Fox y Weisberg 2018</a>)</span>. Las métricas desarrolladas por Cook, Belsley, Kuh y Welsch proporcionan herramientas robustas para este diagnóstico.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Fundamento teórico: de los residuos simples a los estudentizados">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fundamento teórico: de los residuos simples a los estudentizados
</div>
</div>
<div class="callout-body-container callout-body">
<p>Antes de analizar las métricas de influencia, debemos entender por qué no todos los <strong>residuos simples</strong> (<span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>) son comparables entre sí. El problema fundamental es que <strong>no tienen la misma varianza</strong>, incluso bajo homocedasticidad.</p>
<p>La varianza teórica del residuo <span class="math inline">\(e_i\)</span> depende del <strong>apalancamiento</strong> (<em>leverage</em>) de la observación: <span class="math display">\[
\text{Var}(e_i) = \sigma^2(1 - h_{ii})
\]</span></p>
<p>donde el apalancamiento <span class="math inline">\(h_{ii}\)</span> se define como: <span class="math display">\[
h_{ii} = \frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{j=1}^{n}(x_j - \bar{x})^2}
\]</span></p>
<p>Las observaciones con valores de <span class="math inline">\(X\)</span> más alejados de la media tendrán mayor apalancamiento y, paradójicamente, residuos con <strong>menor varianza</strong>. Por esto, un residuo pequeño en una observación de alto leverage puede ser más preocupante que un residuo grande en el centro de los datos.</p>
<p><strong>Los residuos estandarizados</strong> solucionan parcialmente este problema: <span class="math display">\[
r_i^* = \frac{e_i}{\sqrt{\text{MSE}(1 - h_{ii})}}
\]</span></p>
<p>Pero <strong>los residuos estudentizados</strong> van un paso más allá, eliminando el sesgo de autoinfluencia: <span class="math display">\[
r_i = \frac{e_i}{\sqrt{\text{MSE}_{(-i)}(1 - h_{ii})}}
\]</span></p>
<p>donde <span class="math inline">\(\text{MSE}_{(-i)}\)</span> excluye la observación <span class="math inline">\(i\)</span> del ajuste. Esto evita que un outlier “contamine” su propia evaluación y proporciona una distribución teórica exacta (t de Student con <span class="math inline">\(n-k-2\)</span> grados de libertad).</p>
<p><strong>¿Por qué son superiores los residuos estudentizados?</strong> Por tres razones clave: (1) <strong>eliminan el sesgo de autoinfluencia</strong> al excluir cada observación de su propia evaluación, (2) <strong>evitan la contaminación</strong> que un outlier produce en la MSE global, y (3) <strong>siguen una distribución conocida</strong> (t de Student) que permite umbrales estadísticamente precisos. <strong>En la práctica:</strong> <span class="math inline">\(|r_i| &gt; 2\)</span> indica posibles outliers (≈5% en normalidad) y <span class="math inline">\(|r_i| &gt; 3\)</span> outliers muy probables (&lt;1%).</p>
</div>
</div>
<p>Las métricas fundamentales de influencia para identificar observaciones problemáticas son:</p>
<ul>
<li><p><strong>Apalancamiento (Leverage,</strong> <span class="math inline">\(h_{ii}\)</span>): Mide cuán atípico es el valor de la variable predictora <span class="math inline">\(X_i\)</span> de una observación. Un apalancamiento alto significa que el punto tiene el <em>potencial</em> de ser muy influyente. En regresión simple, se calcula como: <span class="math display">\[ h_{ii} = \frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{j=1}^{n}(x_j - \bar{x})^2} \]</span> Una regla común es considerar un apalancamiento alto si <span class="math inline">\(h_{ii} &gt; \frac{2(k+1)}{n}\)</span>, donde <span class="math inline">\(k\)</span> es el número de predictores (1 en regresión simple).</p></li>
<li><p><strong>Distancia de Cook (</strong><span class="math inline">\(D_i\)</span>): Mide la influencia global de una observación, combinando su apalancamiento y su residuo. Representa cuánto cambian los coeficientes del modelo si la i-ésima observación es eliminada. <span class="math display">\[ D_i = \frac{r_i^2}{k+1} \cdot \frac{h_{ii}}{1-h_{ii}} \]</span> Se considera que un punto es influyente si su distancia de Cook es grande, por ejemplo, si <span class="math inline">\(D_i &gt; 1\)</span> o <span class="math inline">\(D_i &gt; 4/(n-k-1)\)</span>.</p></li>
<li><p><strong>DFFITS:</strong> Mide cuánto cambia la predicción <span class="math inline">\(\hat{y}_i\)</span> cuando se elimina la i-ésima observación. Es una medida estandarizada que combina el residuo estudentizado y el apalancamiento. <span class="math display">\[ \text{DFFITS}_i = r_i \sqrt{\frac{h_{ii}}{1-h_{ii}}} \]</span> Un punto se considera influyente si <span class="math inline">\(|\text{DFFITS}_i| &gt; 2\sqrt{(k+1)/n}\)</span>, donde <span class="math inline">\(k\)</span> es el número de predictores.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Cálculo y análisis de DFFITS">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Cálculo y análisis de DFFITS
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>DFFITS es especialmente útil para evaluar cómo cada observación afecta a su propia predicción. Analicemos esta medida con nuestro <code>modelo_estudio</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular DFFITS y sus componentes</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dffits_vals <span class="ot">&lt;-</span> <span class="fu">dffits</span>(modelo_estudio)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>residuos_stud <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(modelo_estudio)  <span class="co"># Residuos estudentizados</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>leverage_vals <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_estudio)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear dataframe para análisis</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>datos_dffits <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">observacion =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dffits_vals),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dffits =</span> dffits_vals,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuo_stud =</span> residuos_stud,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">leverage =</span> leverage_vals</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Umbral de DFFITS</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># número de predictores</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>dffits_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de DFFITS</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_dffits, <span class="fu">aes</span>(<span class="at">x =</span> observacion, <span class="at">y =</span> dffits)) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span>dffits_threshold, dffits_threshold), </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"DFFITS por Observación"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Número de Observación"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"DFFITS"</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Líneas rojas: umbrales ±"</span>, <span class="fu">round</span>(dffits_threshold, <span class="dv">3</span>))</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis cuantitativo</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>influential_dffits <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(dffits_vals) <span class="sc">&gt;</span> dffits_threshold)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>top_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">abs</span>(dffits_vals), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dffits" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dffits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-dffits-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dffits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.11: Análisis de DFFITS para identificar observaciones que afectan significativamente a sus propias predicciones.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Análisis de resultados:</strong></p>
<p>El umbral de influencia para DFFITS es 0.283. En nuestro modelo, <strong>7 observaciones superan este umbral</strong>: las observaciones 6, 20, 22, 47, 85, 87, 89, lo que las clasifica como influyentes según este criterio.</p>
<p>Las <strong>cinco observaciones con mayor |DFFITS|</strong> son las observaciones 20, 85, 89, 47, 6, con valores de 0.446, -0.38, 0.364, 0.325, 0.312 respectivamente. Lo más notable es que <strong>todas estas cinco observaciones</strong> (20, 85, 89, 47, 6) <strong>superan el umbral de DFFITS</strong>, confirmando su carácter influyente.</p>
<p><strong>Interpretación clave:</strong> La observación 20 es el caso más destacado: tiene un DFFITS de 0.446, superando el umbral de 0.283. Esta combinación de residuo y apalancamiento resulta en un DFFITS significativo que indica cambios sustanciales en su predicción.</p>
<p><strong>Conclusión práctica:</strong> Tenemos <strong>7 observaciones influyentes</strong> según DFFITS (6, 20, 22, 47, 85, 87, 89) que merecen investigación adicional. Estas observaciones cambian significativamente sus propias predicciones cuando son eliminadas del modelo, sugiriendo que podrían representar casos especiales o errores de medición que deberían ser examinados más detalladamente.</p>
</div>
</div>
</div>
<p>El gráfico <strong><code>Residuals vs. Leverage</code></strong> es la herramienta visual más importante para el diagnóstico de influencia, ya que combina en un solo gráfico el <strong>apalancamiento</strong> (eje X) y los <strong>residuos estudentizados</strong> (eje Y), permitiendo identificar simultáneamente observaciones con alto leverage y outliers. Además, incluye curvas que delimitan regiones de alta <strong>Distancia de Cook</strong>, facilitando la identificación visual de los puntos más problemáticos.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo: Gráfico Residuals vs. Leverage">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo: Gráfico Residuals vs.&nbsp;Leverage
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a analizar el gráfico más importante para el diagnóstico de influencia usando nuestro <code>modelo_estudio</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos para el gráfico Residuals vs. Leverage</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>leverage_vals <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_estudio)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>residuos_stud <span class="ot">&lt;-</span> <span class="fu">rstudent</span>(modelo_estudio)  <span class="co"># Residuos estudentizados</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>cook_dist <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo_estudio)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>datos_leverage <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">leverage =</span> leverage_vals,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuos_stud =</span> residuos_stud,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cook =</span> cook_dist,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">observacion =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(leverage_vals)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular umbrales</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>leverage_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>cook_threshold <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> (n <span class="sc">-</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para crear curvas de Cook</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>cook_curve <span class="ot">&lt;-</span> <span class="cf">function</span>(leverage, cook_value, k) {</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(cook_value <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> leverage) <span class="sc">/</span> leverage)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear curvas de Cook para diferentes valores</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>lev_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fu">max</span>(leverage_vals) <span class="sc">*</span> <span class="fl">1.1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>cook_05 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">leverage =</span> lev_seq,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">pos =</span> <span class="fu">cook_curve</span>(lev_seq, <span class="fl">0.5</span>, k),</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">neg =</span> <span class="sc">-</span><span class="fu">cook_curve</span>(lev_seq, <span class="fl">0.5</span>, k)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>cook_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">leverage =</span> lev_seq,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">pos =</span> <span class="fu">cook_curve</span>(lev_seq, <span class="dv">1</span>, k),</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">neg =</span> <span class="sc">-</span><span class="fu">cook_curve</span>(lev_seq, <span class="dv">1</span>, k)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico Residuals vs. Leverage con ggplot2</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_leverage, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> residuos_stud)) <span class="sc">+</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Curvas de Cook</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cook_05, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> pos), </span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cook_05, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> neg), </span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cook_1, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> pos), </span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cook_1, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> neg), </span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Puntos de datos</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Líneas de referencia</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> leverage_threshold, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Etiquetas</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Residuals vs. Leverage"</span>,</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos Estudentizados"</span>,</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Curvas rojas: Cook 0.5 (discontinua) y 1.0 (continua) | Líneas naranjas: ±2 | Línea morada: umbral leverage"</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar observaciones problemáticas</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>high_leverage <span class="ot">&lt;-</span> <span class="fu">which</span>(leverage_vals <span class="sc">&gt;</span> leverage_threshold)</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>outliers_stud <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(residuos_stud) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>high_cook <span class="ot">&lt;-</span> <span class="fu">which</span>(cook_dist <span class="sc">&gt;</span> cook_threshold)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-leverage-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.12: Gráfico Residuals vs.&nbsp;Leverage para identificar observaciones influyentes.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Análisis del gráfico:</strong></p>
<p>El gráfico revela varios puntos importantes. Tenemos 6 outliers (residuos estudentizados &gt; 2): las observaciones 20, 22, 47, 85, 89, 99. Además, 2 observaciones superan el umbral de leverage (&gt; 0.04): las observaciones 24, 74.</p>
<p><strong>Interpretación por regiones:</strong></p>
<ul>
<li><strong>Zona derecha (alto leverage)</strong>: Las observaciones 24, 74 superan el umbral de leverage, lo que significa que tienen valores de X atípicos y <strong>alto potencial influyente</strong></li>
<li><strong>Zona izquierda superior/inferior</strong>: Los 6 outliers (20, 22, 47, 85, 89, 99) están distribuidos aquí, con leverage bajo-moderado pero residuos grandes</li>
<li><strong>Esquinas críticas</strong>: Afortunadamente vacías (alto leverage + outlier sería muy problemático)</li>
</ul>
<p><strong>Distancia de Cook:</strong> Las curvas rojas muestran que aunque ningún punto supera Cook = 1.0 (línea continua), <strong>varios puntos se acercan a la curva de Cook = 0.5</strong> (línea discontinua), indicando influencia moderada. Las observaciones con alto leverage están en esta zona de influencia moderada.</p>
<p><strong>Conclusión práctica:</strong> El modelo presenta una <strong>situación favorable</strong>: aunque tenemos <strong>outliers</strong> (observaciones 20, 22, 47, 85, 89, 99) que son atípicos en Y, y <strong>observaciones de alto leverage</strong> (observaciones 24, 74) que son atípicos en X, <strong>crucialmente no hay solapamiento entre ambos grupos</strong>. Esto significa que no tenemos la situación más problemática (alto leverage + outlier). Aun así, ambos grupos merecen investigación.</p>
</div>
</div>
</div>
<section id="interpretación-práctica-de-las-medidas-de-influencia" class="level4" data-number="2.6.6.1">
<h4 data-number="2.6.6.1" class="anchored" data-anchor-id="interpretación-práctica-de-las-medidas-de-influencia"><span class="header-section-number">2.6.6.1</span> Interpretación práctica de las medidas de influencia</h4>
<p>Cada medida nos proporciona información complementaria sobre diferentes aspectos de la influencia:</p>
<ul>
<li><p><strong>Leverage (Apalancamiento):</strong> Identifica observaciones con valores “raros” en las variables predictoras. Alto leverage no es necesariamente problemático, pero indica potencial para ser influyente.</p></li>
<li><p><strong>Distancia de Cook:</strong> Es la medida más general de influencia. Valores altos indican que eliminar esa observación cambiaría substancialmente los coeficientes del modelo.</p></li>
<li><p><strong>DFFITS:</strong> Se enfoca específicamente en cómo cambia la predicción de cada punto cuando se elimina esa observación. Es especialmente útil para evaluar el impacto en las predicciones.</p></li>
</ul>
<p>En la práctica, una observación es especialmente preocupante si es problemática según <strong>múltiples criterios</strong> a la vez.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Diagnóstico completo del modelo de estudio">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Diagnóstico completo del modelo de estudio
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A continuación, realizamos todas las verificaciones de diagnóstico para nuestro <code>modelo_estudio</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar todos los datos necesarios para los gráficos</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>residuos_completo <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modelo_estudio)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>valores_ajustados_completo <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modelo_estudio)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>residuos_std <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modelo_estudio)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>leverage_vals <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_estudio)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Gráfico Residuos vs. Valores Ajustados</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>p1_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> valores_ajustados_completo, <span class="at">y =</span> residuos_completo), </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuos vs. Valores Ajustados"</span>, <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>, <span class="at">y =</span> <span class="st">"Residuos"</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Gráfico Q-Q Normal</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>datos_qq_completo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos_std)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>p2_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos_qq_completo, <span class="fu">aes</span>(<span class="at">sample =</span> residuos)) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span>, <span class="at">x =</span> <span class="st">"Cuantiles Teóricos"</span>, <span class="at">y =</span> <span class="st">"Cuantiles de la Muestra"</span>) <span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Gráfico Scale-Location</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>p3_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> valores_ajustados_completo, </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(residuos_std))), </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scale-Location"</span>, <span class="at">x =</span> <span class="st">"Valores Ajustados"</span>, </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">sqrt</span>(<span class="st">"|Residuos Estandarizados|"</span>))) <span class="sc">+</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Gráfico Residuos vs. Leverage</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>p4_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> leverage_vals, <span class="at">y =</span> residuos_std), </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuos vs. Leverage"</span>, <span class="at">x =</span> <span class="st">"Leverage"</span>, <span class="at">y =</span> <span class="st">"Residuos Estandarizados"</span>) <span class="sc">+</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Histograma de residuos</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>p5_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">residuos =</span> residuos_completo), <span class="fu">aes</span>(<span class="at">x =</span> residuos)) <span class="sc">+</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(residuos_completo), <span class="at">sd =</span> <span class="fu">sd</span>(residuos_completo)),</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograma de Residuos"</span>, <span class="at">x =</span> <span class="st">"Residuos"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Residuos vs. Orden</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>p6_completo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">orden =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(residuos_completo), </span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">residuos =</span> residuos_completo), </span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> orden, <span class="at">y =</span> residuos)) <span class="sc">+</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuos vs. Orden"</span>, <span class="at">x =</span> <span class="st">"Orden de observación"</span>, <span class="at">y =</span> <span class="st">"Residuos"</span>) <span class="sc">+</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>)</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar todos los gráficos en una rejilla 2x3</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1_completo, p2_completo, p3_completo, </span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>             p4_completo, p5_completo, p6_completo, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas analíticas</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== DIAGNÓSTICO ANALÍTICO ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== DIAGNÓSTICO ANALÍTICO ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Verificación de media nula de residuos</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>media_residuos <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">residuals</span>(modelo_estudio))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Media de los residuos:"</span>, <span class="fu">round</span>(media_residuos, <span class="dv">10</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Media de los residuos: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(Debe ser prácticamente 0)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Debe ser prácticamente 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Homocedasticidad: Breusch-Pagan</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"HOMOCEDASTICIDAD - Prueba de Breusch-Pagan:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>HOMOCEDASTICIDAD - Prueba de Breusch-Pagan:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> <span class="fu">bptest</span>(modelo_estudio)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bp_test)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_estudio
BP = 0.019638, df = 1, p-value = 0.8886</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretación: p-valor &gt;"</span>, <span class="fl">0.05</span>, <span class="st">"→ No hay evidencia de heterocedasticidad</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretación: p-valor &gt; 0.05 → No hay evidencia de heterocedasticidad</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Normalidad: Shapiro-Wilk</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NORMALIDAD - Prueba de Shapiro-Wilk:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NORMALIDAD - Prueba de Shapiro-Wilk:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sw_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(modelo_estudio))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sw_test)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(modelo_estudio)
W = 0.99008, p-value = 0.671</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretación: p-valor &gt;"</span>, <span class="fl">0.05</span>, <span class="st">"→ No hay evidencia contra la normalidad</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretación: p-valor &gt; 0.05 → No hay evidencia contra la normalidad</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Independencia: Durbin-Watson</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INDEPENDENCIA - Prueba de Durbin-Watson:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>INDEPENDENCIA - Prueba de Durbin-Watson:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dw_test <span class="ot">&lt;-</span> <span class="fu">dwtest</span>(modelo_estudio)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estadístico DW:"</span>, <span class="fu">round</span>(dw_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estadístico DW: 2.056 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-valor:"</span>, <span class="fu">format.pval</span>(dw_test<span class="sc">$</span>p.value, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">eps=</span><span class="fl">0.001</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-valor: 0.61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretación: Estadístico ≈ 2 y p-valor &gt;"</span>, <span class="fl">0.05</span>, <span class="st">"→ No hay autocorrelación</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretación: Estadístico ≈ 2 y p-valor &gt; 0.05 → No hay autocorrelación</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Identificación de observaciones influyentes</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"OBSERVACIONES INFLUYENTES:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OBSERVACIONES INFLUYENTES:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos las métricas principales</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo_estudio)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>cook_dist <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo_estudio)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modelo_estudio)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>dffits_vals <span class="ot">&lt;-</span> <span class="fu">dffits</span>(modelo_estudio)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>covratio_vals <span class="ot">&lt;-</span> <span class="fu">covratio</span>(modelo_estudio)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Umbrales de corte</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># número de predictores</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>leverage_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>cook_threshold <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> (n <span class="sc">-</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>dffits_threshold <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>covratio_threshold <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificamos observaciones problemáticas</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>high_leverage <span class="ot">&lt;-</span> <span class="fu">which</span>(leverage <span class="sc">&gt;</span> leverage_threshold)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>influential_cook <span class="ot">&lt;-</span> <span class="fu">which</span>(cook_dist <span class="sc">&gt;</span> cook_threshold)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_residuals) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>influential_dffits <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(dffits_vals) <span class="sc">&gt;</span> dffits_threshold)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>problematic_covratio <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(covratio_vals <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&gt;</span> covratio_threshold)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observaciones con alto apalancamiento (&gt;"</span>, <span class="fu">round</span>(leverage_threshold, <span class="dv">3</span>), <span class="st">"):"</span>, </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">length</span>(high_leverage) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">paste</span>(high_leverage, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"Ninguna"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observaciones con alto apalancamiento (&gt; 0.04 ): 24, 74 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observaciones influyentes por Cook (&gt;"</span>, <span class="fu">round</span>(cook_threshold, <span class="dv">3</span>), <span class="st">"):"</span>, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">length</span>(influential_cook) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">paste</span>(influential_cook, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"Ninguna"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observaciones influyentes por Cook (&gt; 0.041 ): 6, 20, 47, 85, 87, 89 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observaciones influyentes por DFFITS (&gt;"</span>, <span class="fu">round</span>(dffits_threshold, <span class="dv">3</span>), <span class="st">"):"</span>, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">length</span>(influential_dffits) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">paste</span>(influential_dffits, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"Ninguna"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observaciones influyentes por DFFITS (&gt; 0.283 ): 6, 20, 22, 47, 85, 87, 89 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Posibles outliers (|residuo std| &gt; 2):"</span>, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(<span class="fu">length</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">paste</span>(outliers, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"Ninguna"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Posibles outliers (|residuo std| &gt; 2): 20, 22, 47, 85, 89, 99 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de observaciones más problemáticas</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>all_problematic <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(high_leverage, influential_cook, influential_dffits, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                           problematic_covratio, outliers))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(all_problematic) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RESUMEN - Observaciones que requieren atención:"</span>, <span class="fu">paste</span>(all_problematic, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Estas observaciones deberían ser investigadas más detalladamente.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RESUMEN - No hay observaciones problemáticas detectadas.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
RESUMEN - Observaciones que requieren atención: 24, 74, 6, 20, 47, 85, 87, 89, 22, 99 
Estas observaciones deberían ser investigadas más detalladamente.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-diagnostico-completo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diagnostico-completo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tema1_files/figure-html/fig-diagnostico-completo-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diagnostico-completo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.13: Gráficos de diagnóstico completo del modelo de regresión.
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Conclusión del diagnóstico:</strong></p>
<p>Nuestro modelo de estudio pasa exitosamente todas las verificaciones: - ✅ <strong>Linealidad</strong>: Sin patrones en residuos vs ajustados - ✅ <strong>Homocedasticidad</strong>: Varianza constante (Breusch-Pagan p &gt; 0.05) - ✅ <strong>Normalidad</strong>: Los residuos siguen distribución normal (Shapiro-Wilk p &gt; 0.05) - ✅ <strong>Independencia</strong>: Sin autocorrelación (Durbin-Watson ≈ 2) - ✅ <strong>Media nula</strong>: La media de residuos es prácticamente 0 - ✅ <strong>Sin valores influyentes</strong>: No hay observaciones problemáticas según Cook, DFFITS o COVRATIO - ✅ <strong>Sin outliers</strong>: No hay residuos estandarizados extremos</p>
<p>Esto confirma que nuestras inferencias estadísticas (p-valores, intervalos de confianza) son válidas y confiables <span class="citation" data-cites="james2021 harrell2015">(<a href="references.html#ref-james2021" role="doc-biblioref">James et&nbsp;al. 2021</a>; <a href="references.html#ref-harrell2015" role="doc-biblioref">Harrell 2015</a>)</span>.</p>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-draper1998applied" class="csl-entry" role="listitem">
Draper, NR. 1998. <em>Applied regression analysis</em>. McGraw-Hill. Inc.
</div>
<div id="ref-fox2018r" class="csl-entry" role="listitem">
Fox, John, y Sanford Weisberg. 2018. <em>An R companion to applied regression</em>. Sage publications.
</div>
<div id="ref-galton1886" class="csl-entry" role="listitem">
Galton, Francis. 1886. <span>«Regression towards mediocrity in hereditary stature»</span>. <em>The Journal of the Anthropological Institute of Great Britain and Ireland</em> 15: 246-63.
</div>
<div id="ref-harrell2015" class="csl-entry" role="listitem">
Harrell, Frank E., Jr. 2015. <em>Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis</em>. Second. Springer.
</div>
<div id="ref-james2021" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, y Robert Tibshirani. 2021. <em>An Introduction to Statistical Learning with Applications in R</em>. Second. Springer.
</div>
<div id="ref-kutner2005applied" class="csl-entry" role="listitem">
Kutner, Michael H, Christopher J Nachtsheim, John Neter, y William Li. 2005. <em>Applied linear statistical models</em>. McGraw-hill.
</div>
<div id="ref-weisberg2005applied" class="csl-entry" role="listitem">
Weisberg, S. 2005. <span>«Applied linear regression»</span>. Wiley.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tema0.html" class="pagination-link" aria-label="Introducción a los modelos de regresión">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción a los modelos de regresión</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tema2.html" class="pagination-link" aria-label="Métodos de selección de variables y problemas de regularización">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Métodos de selección de variables y problemas de regularización</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>